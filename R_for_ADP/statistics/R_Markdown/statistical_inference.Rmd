---
title: "10장 통계적 추론"
author: "Taeyoon Kim"
date: "2024-05-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<br/>

### 10.2 모평균의 추정(표본의 크기가 클 때)

<br/>

#### 10.2.2 표본의 크기 $n=48$, 표본평균 $\bar{x}=86.5$, 표본표준편차 $s=7.9$라고 할 때 모평균 $\mu$의 90% 신뢰구간을 구하라.

```{r}
n=48
x_bar=86.5
s=7.9

lowerbound = x_bar + qnorm(0.05) * s / sqrt(n)
upperbound = x_bar + qnorm(0.95) * s / sqrt(n)

cat("(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.4 한 연구자가 모평균의 90% 신뢰구간을 구한다고 하자. 그러한 작업을 200번 하였다고 하면 몇 개의 신뢰구간이 실제의 평균을 포함하고 있겠는가?

180개  
신뢰구간은 추정량의 분포를 이용하여 표본으로부터 모수 값을 포함하리라고 예상되는 구간을 구하여 제시하는 것이다.

<br/>

#### 10.2.6 한 자동차 공장에서 38명의 새로운 직원들이 2주 동안의 연수를 마친 후, 특정한 작업을 얼마나 빠른 시간 안에 해 내는지를 측정하였다. 그 작업을 끝내는 데 걸리는 시간의 평균과 표준편차가 각각 68초와 12초였다. 모든 직원들이 2주의 교육을 마쳤을 때 그 작업을 마치는 데 걸리는 시간의 평균값의 95% 신뢰구간을 구하라.

```{r}
n=38
x_bar=68
s=12

lowerbound = x_bar + qnorm(0.025) * s / sqrt(n)
upperbound = x_bar + qnorm(0.975) * s / sqrt(n)

cat("(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.8 비정규직 근로자 50명의 월급을 조사하였더니 평균이 88만 원이고, 표준편차가 10만 원이었다. 평균 월급에 대한 90% 신뢰구간을 구하라.

```{r}
n=50
x_bar=88
s=10

lowerbound = x_bar + qnorm(0.05) * s / sqrt(n)
upperbound = x_bar + qnorm(0.95) * s / sqrt(n)

cat("(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.10 한 엔지니어는 고속도로의 파손된 부분을 수리하는 데 쓰이는 새로운 혼합 시멘트가 굳기까지 걸리는 시간을 측정하려고 한다. 100군데의 파손된 부분을 수리하여 굳기까지의 시간을 조사해 보니, 표본의 평균과 표준편차가 각각 32분과 4분으로 조사되었다. 시멘트가 굳기까지의 평균시간($\mu$)에 대한 99% 신뢰구간을 구하라.

```{r}
n=100
x_bar=32
s=4

lowerbound = x_bar + qnorm(0.005) * s / sqrt(n)
upperbound = x_bar + qnorm(0.995) * s / sqrt(n)

cat("(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.12 어느 회사에서 생산된 전자레인지 65개를 임의로 뽑아 전자파의 양을 측정하여 $\bar{x}=0.11, s=0.06$을 얻었다. 모집단의 평균 전자파량의 95% 신뢰구간을 구하라.

```{r}
n=65
x_bar=0.11
s=0.06

lowerbound = x_bar + qnorm(0.025) * s / sqrt(n)
upperbound = x_bar + qnorm(0.975)* s / sqrt(n)

cat("(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.14 모집단으로부터 충분히 큰 표본을 뽑아 모평균($\mu$)에 대한 95%의 신뢰구간 (52.6, 58.2)를 얻었다. 다음을 계산하라.

##### (1) 모평균($\mu$)의 점추정치와 추정량의 표준오차를 구하라.

##### (2) 모평균($\mu$)에 대한 80% 신뢰구간을 계산하라.

```{r}
point = (52.6 + 58.2) / 2
se = (58.2 - point) / 1.96
lowerbound = point + qnorm(0.1) * se
upperbound = point + qnorm(0.9) * se

cat(" (1)", "점추정치:", point, ", 표준오차:", se, "\n", "(2)", "(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.16 어떤 화학실험에서 구리 침전물량의 표준편차가 4.5g이라고 하자. 이때 모평균에 대한 표본평균의 오차가 1.86g 이하가 될 확률이 최소한 99%가 되도록 한다면 몇 번의 실험을 반복해야 하는가?

```{r}
s = 4.5
answer = (qnorm(0.995) * s / 1.86)^2

cat(ceiling(answer))
```

<br/>

#### 10.2.18 62명의 6세의 여자아이들을 임의로 뽑아 그들의 키에 대한 모평균의 95% 신뢰구간을 구하였더니 (107.2cm, 127.1cm)였다고 하자. 다음 물음에 "예", "아니오", 혹은 "알 수 없다"로 답하라.

##### (1) 표본평균이 (107.2, 127.1) 안에 있는가?

##### (2) 모평균이 (107.2, 127.1) 안에 있는가?

##### (3) 다시 62명의 6세 여자아이들의 표본을 추출한다면 이 표본의 평균이 (107.2, 127.1)의 구간 안에 있겠는가?

##### (4) 표본의 95%가 (107.2, 127.1)의 구간 안에 포함되는가?

##### (5) 같은 자료로부터 99%와 같이 더 높은 신뢰수준의 신뢰구간을 구한다면 그 구간이 (107.2, 127.1)보다 좁아지겠는가?

```{r}
cat(
  " (1)", "예", "\n", 
   "(2)", "알 수 없다", "\n", 
   "(3)", "알 수 없다", "\n", 
   "(4)", "아니오", "\n", 
   "(5)", "아니오"
)
```

<br/>

### 10.3 모평균에 대한 검정(표본의 크기가 클 때)

<br/>

#### 10.3.6 검정통계량 Z를 계산하고, 주어진 유의수준 $\alpha$를 갖고 결론을 설명하라.

##### (1) $\bar{x}=30.54, \sigma=2, \mu>30, n=55, \alpha=0.05$

```{r}
x_bar=30.54
sigma=2
mu=30
n=55
alpha=0.05

z = (x_bar - mu) / (sigma/sqrt(n))
if (z > qnorm(0.95)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

cat("(1) 검정통계량z:", z, ",", message)

```

##### (2) $\bar{x}=0.142, \sigma=0.085, \mu<0.15, n=150, \alpha=0.025$

```{r}
x_bar=0.142
sigma=0.085
mu=0.15
n=150
alpha=0.025

z = (x_bar - mu) / (sigma/sqrt(n))
if (z < qnorm(alpha)) {
  message = sprintf("유의수준 %.3f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.3f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

cat("(2) 검정통계량z:", z, ",", message)

```

##### (3) $\bar{x}=72.35, \sigma=8.6, \mu \neq 75, n=38, \alpha=0.01$

```{r}
x_bar=72.35
sigma=8.6
mu=75
n=38
alpha=0.01

z = (x_bar - mu) / (sigma/sqrt(n))
if ((z < qnorm(alpha/2)) | (z > qnorm(1-alpha/2))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

cat("(3) 검정통계량z:", z, ",", message)

```

##### (4) $\bar{x}=-0.79, \sigma=1.62, \mu \neq 0, n=40, \alpha=0.06$

```{r}
x_bar=-0.79
sigma=1.62
mu=0
n=40
alpha=0.06

z = (x_bar - mu) / (sigma/sqrt(n))
if ((z < qnorm(alpha/2)) | (z > qnorm(1-alpha/2))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

cat("(4) 검정통계량z:", z, ",", message)

```

<br/>

#### 10.3.8 한 대학서점으로부터 임의로 추출한 40개의 영수증을 조사한 결과 표본평균 $\bar{x}=5$만 원, 표본표준편차 $s=9$천 원이라고 한다. 이 값들을 이용해서 한 번에 판매한 평균액수($\mu$)에 대한 가설 $H_0: \mu=46000$ 대 $H_1:\mu \neq 46000$을 유의수준 0.05에서 검정하라.

```{r}
x_bar=50000
s=9000
mu=46000
n=40
alpha=0.05

z = (x_bar - mu) / (s/sqrt(n))
if ((z < qnorm(alpha/2)) | (z > qnorm(1-alpha/2))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

cat("검정통계량z:", z, ",", message)

```

<br/>

#### 10.3.10 가설 $H_0: \mu=1100$ 대 $H_1:\mu \neq 1100$에 대한 검정을 하기 위하여 80개의 측정값으로 이루어진 표본을 얻었다. 표본평균과 표본표준편차는 각각 1,060과 210으로 나타났다.

##### (1) 유의수준 1%에서 가설검정을 시행하라.

##### (2) P-값을 계산하고 그 결과에 대하여 해석하라.

```{r}
x_bar=1060
s=210
mu=1100
n=80
alpha=0.01

z = (x_bar - mu) / (s/sqrt(n))
if ((z < qnorm(alpha/2)) | (z > qnorm(1-alpha/2))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = pnorm(z) * 2

cat(" (1)", message, "\n", "(2)", p_value)

```

<br/>

#### 10.3.12 새로운 치료법이 말기 암환자의 생명 연장에 기존의 치료보다 더 효과적이라는 주장이 있다. 기존의 치료는 오랫동안 사용되어 왔으며 의학 잡지의 기록에 의하여 평균 생존기간이 4.2년으로 알려지고 있다. 새로운 치료법을 80명의 환자들에게 시행하여 그들의 생존기간을 기록한 결과 표본평균과 표본표준편차는 각각 4.5년과 1.1년으로 밝혀졌다. 위의 주장은 이들 결과에 의해 뒷받침될 수 있는가? 유의수준 $\alpha=0.05$에서 검정하라. 또한 P-값도 계산하라.

```{r}
x_bar=4.5
s=1.1
mu=4.2
n=80
alpha=0.05

z = (x_bar - mu) / (s/sqrt(n))
if (z > qnorm(alpha)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = 1- pnorm(z)

cat(message, "\n", "P-값:", p_value)

```

<br/>

#### 10.3.16 한 회사에서는 땅콩, 호두, 마카다미아 등을 혼합하여 캔으로 판매하고 있는데 내용물의 25%가 값비싼 마카다미아라는 표지를 붙이고 있다고 한다. 이 표지가 과대선전일지도 모른다고 생각한 검사자가 35개의 캔을 임의로 추출하여 마카다미아의 혼합비율을 측정하였다. 이들 측정치들의 평균과 표준편차는 각각 23.5와 3.1로 밝혀졌다. 이들 결과들은 검사자의 신념을 지지할 수 있는 강한 증거를 제시하는가?

```{r}
x_bar=23.5
s=3.1
mu=25
n=35
alpha=0.05

z = (x_bar - mu) / (s/sqrt(n))
if (z < qnorm(alpha)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = pnorm(z)

cat(
  message, "\n", 
  "즉, 내용물의 25%가 값비싼 마카다미아라고 보기 힘들다.", "\n", 
  "P-값: ", p_value, sep = ""
)

```

<br/>

#### 10.3.18 다음의 물음에 답하라.

##### (1) 어느 회사에서 자회사 제품의 무게가 다른 회사 제품의 무게 50g보다 크다고 주장하고자 한다. 원하는 가설을 세워라.

##### (2) 실제로 이 회사 제품의 무게가 50g보다 크다면 검정에서 어떤 오류를 범할 수 있는가?

##### (3) 이 회사 제품의 무게에 대한 추론을 위하여 표본을 추출하려고 한다. 95% 신뢰구간의 길이가 1보다 작기를 원한다면 $\sigma=3$이라고 알려져 있을 때 표본의 크기는 얼마가 되어야 하는가?

##### (4) (1)에 대한 검정에서 $H_0$를 기각하였다. 어떤 오류를 범할 수 있는가?

```{r}
answer_1 = "H_0: mu=50 vs H_1: mu>50"

answer_2 = "제 2종 오류"

confidence = 0.975  # 주의! 0.95 가 아니라 0.975이다.
sigma=3
answer_3 = ceiling((2 * qnorm(confidence) * sigma )^2)

answer_4 = "제 1종 오류"

cat(
  " (1) ", answer_1, "\n", 
  "(2) ", answer_2, "\n", 
  "(3) ", answer_3, "\n", 
  "(4) ", answer_4 
)

```

<br/>

#### 10.3.20 표본의 크기가 64인 자료에 대하여 모평균이 65보다 작다는 주장을 검정하고자 한다. $\sigma=5$일 때 다음 물음에 답하라.

##### (1) 이 검정에 대한 기각역이 $R: \bar{X}\leq64$일 때, 제1종 오류를 범할 확률을 구하라.

##### (2) 이 검정에 대한 기각역이 $R: \bar{X}\leq64$이며 실제 모평균은 63.5일 때, 제2종 오류를 범할 확률을 구하라.

##### (3) 이 검정에 대한 기각역이 $R: \bar{X}\leq c$인 검정의 유의수준이 $\alpha=0.01$이 되도록 $c$를 구하라.

```{r}
n=64
mu_0=65
sigma=5
c = (64 - mu_0) / (sigma / sqrt(n))
answer_1 = pnorm(c)

n=64
mu_1=63.5
sigma=5
c = (64 - mu_1) / (sigma / sqrt(n))
answer_2 = 1 - pnorm(c)

n=64
mu_0=65
sigma=5
answer_3 = mu_0 + qnorm(0.01) * sigma / sqrt(n)

cat(
  " (1) ", answer_1, "\n", 
  "(2) ", answer_2, "\n", 
  "(3) ", answer_3
)

```

<br/>

### 10.4 모비율에 대한 추론(표본의 크기가 클 때)

<br/>

#### 10.4.2 모비율 $p$를 추정하기 위해 크기가 $n$인 표본이 임의추출되었고, 그 중 $X$개가 관심있는 성질을 가지고 있는 것으로 판명되었다고 하자. 다음의 각 경우에 대해서 모비율의 90% 신뢰구간을 구하라.

##### (1) $n=50$, $X=31$

##### (2) $n=460$, $X=52$

##### (3) $n=2500$, $X=1977$

```{r}
n=64
mu_0=65
sigma=5
c = (64 - mu_0) / (sigma / sqrt(n))
answer_1 = pnorm(c)

n=64
mu_1=63.5
sigma=5
c = (64 - mu_1) / (sigma / sqrt(n))
answer_2 = 1 - pnorm(c)

n=64
mu_0=65
sigma=5
answer_3 = mu_0 + qnorm(0.01) * sigma / sqrt(n)

cat(
  " (1) ", answer_1, "\n", 
  "(2) ", answer_2, "\n", 
  "(3) ", answer_3
)

```

<br/>

#### 10.4.4 어떤 사람이 A 상표 세제의 시장점유율을 조사한다고 하자. 즉 모든 상표들의 총 판매량에 대한 A 상표의 판매량의 비율을 조사하려고 한다. 그 사람은 몇 개의 상점으로부터 425 상자의 세제가 판매된 가운데 120 상자가 A 상표의 세제였다는 것을 알아냈다고 하자.

##### (1) A 상표 세제의 시장점유율을 추정하라.

##### (2) 표준오차를 추정하라.

##### (3) A 상표의 시장점유율에 대한 95% 신뢰구간을 구하라.

```{r}
p = 120 / 425
n = 425

answer_1 = p
answer_2 = sqrt(p * (1-p) / n)

lowerbound = p + qnorm(0.025) * answer_2
upperbound = p + qnorm(0.975) * answer_2

cat(
  " (1) ", answer_1, "\n", 
  "(2) ", answer_2, "\n", 
  "(3) ", "(", lowerbound, ",", upperbound, ")"
)
```

<br/>

#### 10.4.6 3년 동안 한 산업단지 내의 잣나무 중 90%가 죽은 것으로 밝혀졌다. 공해에 저항력이 강한 새로운 종이 현재 연구 중에 있는데, 첫 실험의 반응을 관찰한 결과, 같은 지역에서 3년 동안 새로운 종 45 개체의 묘목 중에 28 개체가 죽었다고 한다. 새로운 종의 3년간의 고사율을 추정하고 90% 신뢰구간을 구하라.

```{r}
p = 28 / 45
n = 45

lowerbound = p + qnorm(0.05) * sqrt(p * (1 - p) / n)
upperbound = p + qnorm(0.95) * sqrt(p * (1 - p) / n)

cat(
  " 고사율:", p,"\n",
  "90% 신뢰구간:",  "(", lowerbound, ",", upperbound, ")"
)
```

<br/>

#### 10.4.8 1988년에 졸업한 고등학생 중 전국에서 임의로 750명을 대상으로 실시한 설문조사에서 59.8%가 대학에 진학하였고, 4.2%가 직업훈련소에 입소한 반면, 36%는 더 이상의 교육을 받지 못하였다는 결과가 나왔다.

##### (1) 1988년에 졸업한 고등학생 중 대학에 진학한 학생의 모비율에 대한 95% 신뢰구간을 구하라.

##### (2) 1988년에 졸업한 고등학생 중 직업훈련소에 입소한 고등학생의 모비율에 대한 90% 신뢰구간을 구하라.

```{r}
n = 750
p_1 = 0.598
p_2 = 0.042

lowerbound_1 = p_1 + qnorm(0.025) * sqrt(p_1 * (1 - p_1) / n)
upperbound_1 = p_1 + qnorm(0.975) * sqrt(p_1 * (1 - p_1) / n)
answer_1 = paste("(", lowerbound_1, ",", upperbound_1, ")")

lowerbound_2 = p_2 + qnorm(0.05) * sqrt(p_2 * (1 - p_2) / n)
upperbound_2 = p_2 + qnorm(0.95) * sqrt(p_2 * (1 - p_2) / n)
answer_2 = paste("(", lowerbound_2, ",", upperbound_2, ")")

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 10.4.20 위의 연습문제 4.8에서 1988년에 졸업한 고등학생들의 대학진학률이 57%보다 높다고 할 수 있는지 검정하라 (P-값을 계산하고 결과를 설명하라.)

```{r}
n = 750
p_0 = 0.57
x_bar = 0.598
alpha = 0.95

z = (x_bar - p_0) / sqrt(p_0 * (1 - p_0) / n)

if (z > qnorm(alpha)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = 1 - pnorm(z)

cat("P-값:", p_value, ",", message)

```

<br/>

#### 10.4.10 한 심리학 실험에서 각 개인은 어떤 자극에 대하여 A와 B의 두 가지 중 한 가지의 반응만 할 수 있도록 허용되었다. 실험자는 A 반응을 보이는 사람의 비율 $p$를 구하려고 한다. 만약 실험자가 추정치의 오차가 0.04 보다 작을 확률이 최소한 90%가 되게 하려면 최소한 몇 명의 사람들이 그 실험에 필요하겠는가?

```{r}
# 교재 pp.304-305 참고
cat(ceiling(1/4 * (qnorm(0.05) / 0.04)^2))
```

<br/>

#### 10.4.12 연습문제 4.6에서 95% 신뢰를 가지고 추정의 오차가 0.08 안에 들게 하려면, 3년 동안 재배되고 관찰될 새로운 나무의 수는 최소한 얼마가 되어야 하는가? ($p$는 처음 연구에서 얻은 결과를 이용하라.)

```{r}
p = 28 / 45
cat(ceiling((qnorm(0.025) / 0.08)^2 * p * (1-p)))
```

<br/>

#### 10.4.18 정치문제에 관심을 가진 한 시민들의 모임에서, 유권자의 절반 미만이 대통령의 최근 중대국면에 대한 대처방안을 지지하고 있음을 보이려고 한다. 대처방안을 지지하는 유권자의 모비율을 $p$라고 할 때, 다음의 물음에 답하라.

##### (1) $H_0$와 $H_1$을 결정하라.

##### (2) 500명의 유권자로 이루어진 표본 중에 228명이 지지표를 던졌다면, 어떠한 검정결과가 나오겠는가? $\alpha = 0.05$를 사용하고 P-값도 구하라.

```{r}
p_hat = 228 / 500
p_0 = 0.5
n = 500
alpha = 0.05

answer_1 = "H_0 = 0.5 vs H_1 < 0.5"

z = (p_hat - p_0) / sqrt(p_0 * (1 - p_0) / n)

if (z < qnorm(alpha)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = pnorm(z)

cat(" (1)", answer_1, "\n", "(2) P-값:", p_value, ",", message)
```

<br/>

#### 10.4.22 전화 인터뷰를 통한 설문조사에서 980 명의 성인 중 78%가 공해방지를 위한 새로운 법률 제정을 지지하는 것으로 나타났다. 이 결과가 75% 보다 많은 성인 인구가 새로운 공해방지 법안을 지지한다고 하는 추측을 잘 실증하고 있는가? (P-값을 계산하여 설명하라.)

```{r}
x_bar = 0.78
p_0 = 0.75
n = 980
alpha = 0.95

z = (x_bar - p_0) / sqrt(p_0 * (1 - p_0) / n)


if (z < qnorm(alpha)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = 1 - pnorm(z)

cat(
  " P-값:", p_value, ",", message, "\n", 
  "따라서 해당 결과는 추측을 잘 실증한다고 할 수 있다."
)
```

<br/>

### 10.5 종합문제

<br/>

#### 10.5.2 크기가 $n$인 표본으로부터 모평균 $\mu$를 추정하는 문제를 생각해 보자. 아래의 (1)과 (2) 각각의 경우에 대해 모평균 $\mu$를 추정하고 표준오차를 추정하라.

##### (1) $n=80$, $\sum x_i = 752$, $\sum (x_i - \bar{x})^2 = 345$

##### (2) $n=169$, $\sum x_i = 1290$, $\sum (x_i - \bar{x})^2 = 842$

```{r}
n_1 = 80
sigma_x = 752
deviation_squared = 345
x_bar = sigma_x / (n_1)
se = sqrt(deviation_squared / (n_1 -1) ) / sqrt(n_1)
answer_1 = paste("(1) 모평균 추정치: ", x_bar, ", 표준오차: ", se, sep="")

n_2 = 169
sigma_x = 1290
deviation_squared = 842
x_bar = sigma_x / (n_2)
se = sqrt(deviation_squared / (n_2 -1) ) / sqrt(n_2)
answer_2 = paste("(2) 모평균 추정치: ", x_bar, ", 표준오차: ", se, sep="")

cat(answer_1, answer_2, sep="\n")
```

<br/>

#### 10.5.6 어떤 연구자가 모평균을 추정하고자 하는데, 오차가 2.5 이하일 확률이 최소한 95%가 되도록 표본의 크기를 정하려고 한다. 만약 $\sigma=18$로 주어져 있다면 표본의 크기는 얼마로 해야 하겠는가?

```{r}
sigma = 18
answer = ceiling((qnorm(0.975) * sigma / 2.5)^2)

cat(answer)
```

<br/>

#### 10.5.8 어떤 식품 서비스 지배인이 점심시간에 배달하는 샌드위치의 평균 개수를 추정하는데 95%의 신뢰도를 가지고 오차가 10개 이하이기를 원한다고 한다. 초기 표본에서 $\sigma=80$이라면 표본의 크기를 얼마로 해야 하겠는가?

```{r}
sigma = 80
answer = ceiling((qnorm(0.975) * sigma / 10)^2)

cat(answer)
```

<br/>

#### 10.5.10 다음의 각 경우에 대하여 모평균에 대한 $100(1-\alpha)\%$ 신뢰구간을 구하라.

##### (1) $n=60$, $\sum x_i = 752$, $\sum (x_i - \bar{x})^2 = 426$, $1 - \alpha = 0.95$

##### (2) $n=150$, $\sum x_i = 2652$, $\sum (x_i - \bar{x})^2 = 3722$, $1 - \alpha = 0.90$

```{r}
n_1 = 60
sum_x = 752
deviation_squared = 426
x_bar = sum_x / n_1
sigma = sqrt(deviation_squared / (n_1 - 1))
upperbound = x_bar + qnorm(0.975) * sigma / sqrt(n_1)
lowerbound = x_bar + qnorm(0.025) * sigma / sqrt(n_1)

answer_1 = paste("(", lowerbound, ", ", upperbound, ")", sep="")

n_2 = 150
sum_x = 2652
deviation_squared = 3722
x_bar = sum_x / n_2
sigma = sqrt(deviation_squared / (n_2 - 1))
upperbound = x_bar + qnorm(0.95) * sigma / sqrt(n_2)
lowerbound = x_bar + qnorm(0.05) * sigma / sqrt(n_2)

answer_2 = paste("(", lowerbound, ", ", upperbound, ")", sep="")

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 10.5.12 80마리의 쥐에게 특정한 음식을 준 후에 체중 증가량을 측정하여 $\bar{x} = 35$g 이고 $s=4$g인 결과를 얻었다.

##### (1) 평균 증가량에 대한 90% 신뢰구간을 구하라.

##### (2) (1)에서 구한 구간이 실제 평균을 포함하는지 설명하라.

```{r}
n = 80
x_bar = 35
s = 4
upperbound = x_bar + qnorm(0.95) * s / sqrt(n)
lowerbound = x_bar + qnorm(0.05) * s / sqrt(n)

answer_1 = paste("(", lowerbound, ", ", upperbound, ")", sep="")

cat(" (1)", answer_1, "\n", "(2) 실제 평균을 포함하는 경우가 100번 중 90번 정도라는 의미이지 실제로 평균을 포함하는지는 알 수 없다.")

```

<br/>

#### 10.5.14 다음의 각각의 경우에 대하여 관심의 대상이 되는 모수를 적당한 기호로 표현하여 귀무가설 $H_0$와 대립가설 $H_1$을 기술하라.

##### (1) 평균 고속도로 주행거리가 휘발유 1리터당 20km 미만이라는 것을 보이기 위해 어떤 소비자 그룹이 새로운 모델의 몇 대의 차를 대상으로 실험을 계획하였다.

##### (2) 척추교정요법의 성공률이 50% 보다 높다는 주장을 하기 위해 요통으로부터 고통받는 사람수를 조사하려고 한다.

##### (3) 커피를 봉지에 담아 포장하는 기계는 평균이 450g으로 맞춰져 있다고 알려져 있다. 만약 평균값이 450g으로부터 벗어났다면 조정이 필요하다고 하는데, 조정이 필요한지 결정하기 위해서 몇 개의 커피 봉지를 측정하고자 한다.

##### (4) 어떤 농작물의 특성을 연구하는 연구원이 특정한 악조건하에서 옥수수의 새로운 변종의 경우에 30% 미만이 죽는다는 것을 증명하고자 한다.

```{r}
cat(
  "(1) H_0: mu = 20 vs H_1: mu < 20", "\n",
  "(2) H_0: p = 0.5 vs H_1: p > 0.5", "\n",
  "(3) H_0: mu = 450 vs H_1: mu != 450", "\n",
  "(4) H_0: p = 0.3 vs H_0: p < 0.3", sep=""
)
```

<br/>

#### 10.5.16 표본의 크기가 100일 때, $\mu \neq 52$ 임을 보이고자 하는데, 이때 $\sigma=10.6$을 안다고 하자.

##### (1) $R: |\bar{X} - 52| \geq 2.47$ 이도록 기각역을 정하였을 대 $\alpha$ 를 구하라.

##### (2) 기각역이 $R: |\bar{X} - 52| \geq c$ 인 검정의 유의수준이 $\alpha = 0.05$ 이 되도록 $c$를 구하라.

```{r}
n = 100
sigma = 10.6

answer_1 = pnorm(-1 * 2.47 / (sigma / sqrt(n))) * 2  # \alpha/2 이므로 *2
answer_2 = qnorm(0.975) * (sigma / sqrt(n))

cat(
  " (1)", answer_1, "\n",
   "(2)", answer_2
)
```

<br/>

#### 10.5.20 모평균이 8.5라는 귀무가설에 대해 8.5가 아니라는 대립가설을 검정하기 위하여 42개의 표본을 조사하였다. 표본의 평균과 표준편차는 8.79와 1.27임을 알아내었다,

##### (1) 유의수준을 0.1로 해서 가설을 검정하라.

##### (2) P-값을 구하고 결과를 설명하라.

```{r}
n = 42
mu = 8.5
x_bar = 8.79
s = 1.27
alpha = 0.1

z = (x_bar - mu) / (s / sqrt(n))

if (z < qnorm(alpha/2) | z > qnorm(1-alpha/2)) {
  message = sprintf("유의수준 %.1f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.1f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = (1 - pnorm(abs(z))) * 2

cat( 
  " (1)", message, "\n",
   "(2) P-값:", p_value
)
```

<br/>

#### 10.5.22 어느 모집단으로부터 추출한 크기가 49인 표본으로부터 모평균에 대한 95% 신뢰구간을 구하였더니 (22.028, 24.772)이었다. 모집단의 표준편차는 알려져 있지 않다고 한다.

##### (1) 표본평균과 표본표준편차를 계산하라.

##### (2) 모평균을 추정하고, 그 표준오차를 추정하라.

##### (3) 모평균에 대한 90% 신뢰구간을 구하라.

##### (4) 유의수준 5%에서 가설 $H_0: \mu=23.8$ 대 $H_1: \mu \neq 23.8$을 검정하라.


```{r}
# 1번
n=49
mean = (22.028 + 24.772) / 2
s = (mean - 22.028) * sqrt(n) / 1.96
# 2번
se = s / sqrt(n)
# 3번
lowerbound = mean + qnorm(0.05) * s / sqrt(n)
upperbound = mean + qnorm(0.95) * s / sqrt(n)
# 4번
alpha=0.05
z = (23.8 - mean) / (s / sqrt(n))

if (z < qnorm(alpha/2) | z > qnorm(1-alpha/2)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}


cat( 
  " (1) 표본평균:", mean, ", 표본표준편차: ", s, "\n",
   "(2) 모평균추정치:", mean, ", 표준오차: ", se, "\n",
   "(3) (", lowerbound, ",", upperbound, ")", "\n",
   "(4)", message
)
```

<br/>

#### 10.5.24 큰 도시의 노동인구로부터 2000명을 임의추출하여 인터뷰를 하였더니 165명이 직업을 갖지 않은 것으로 밝혀졌다.

##### (1) 자료에 근거하여 실업률을 추정하라.

##### (2) 실업률에 대한 95% 신뢰구간을 구하라.

```{r}
n=2000
p=165/2000
var=p * (1-p)

answer_1 = p

lowerbound = p + qnorm(0.025) * sqrt(var/n)
upperbound = p + qnorm(0.975) * sqrt(var/n)

answer_2 = paste("(", lowerbound, ",", upperbound, ")")

cat("(1)", answer_1, "\n(2)", answer_2)

```

<br/>

#### 10.5.26 어느 도시의 교육청에서는 올해부터 실시한 수돗물의 불소화 시행이 그 지역 초등학생 중 충치가 있는 비율에 어떤 변화를 주었는지 관심이 있다고 한다. 올해 초등학생의 충치비율을 $p$라고 하자. 초등학생의 충치비율이 60%는 넘지 않는다고 알려져 있을 때, $p$에 대한 추정량의 95% 오차가 0.03을 넘지 않으려면 몇 명의 학생을 검사해야 하겠는가?

```{r}
d = 0.03

cat (ceiling(1/4 * (1.96/d)^2))
```

<br/>

#### 10.5.28 $p$를 지난해에 미국의 어느 도시에서 법률상담한 성인의 비율이라고 하자.

##### (1) $\alpha=0.05$일 때 $H_0: p=0.25$ 대 $H_1: p > 0.25$ 의 가설에 대한 기각역을 정하라.

##### (2) 200 명의 임의추출된 표본에서 65명이 법률상담을 의뢰하였다고 하면 검정결과는 어떻게 되겠는가?

##### (3) $p$에 대한 90% 신뢰구간을 계산하라.

```{r}
alpha=0.05
p=0.25
n=200
p_hat=65/200 

answer_1 = "가설에 대한 검정통계량은 Z = (p_hat - p) / sqrt(p * (1-p) / n) 이므로 기각역은 R: Z > 1.645이다."

z = (p_hat - p) / sqrt(p * (1-p) / n)

if (z > qnorm(1-alpha)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

lowerbound = p_hat + qnorm(0.05) * sqrt(p * (1-p) / n)
upperbound = p_hat + qnorm(0.95) * sqrt(p * (1-p) / n)

answer_3 = paste("(", lowerbound, ",", upperbound, ")")

cat("(1)", answer_1, "\n(2)", message, "\n(3)", answer_3)
```

<br/>

#### 10.5.30 표본의 크기를 170으로 하여, 모비율이 0.4보다 크다는 주장을 증명하고자 한다.

##### (1) 만약 기각역이 $R: \hat{p} \geq 0.453$이면 이 검정의 유의수준은 얼마인가?

##### (2) 기각역이 $R: \hat{p} \geq c$인 검정의 유의수준이 $\alpha=0.025$이기 위한 $c$를 결정하라.

```{r}
n=170
p=0.4

z_0 = (0.453-p) / sqrt(p * (1-p) / n)
answer_1 = 1 - pnorm(z_0)
answer_2 = qnorm(0.975) * sqrt(p * (1-p) / n) + p

cat("(1)", answer_1, "\n(2)", answer_2)
```







