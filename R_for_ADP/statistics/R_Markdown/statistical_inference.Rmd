---
title: "10장 통계적 추론"
author: "Taeyoon Kim"
date: "2024-05-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<br/>

### 10.2 모평균의 추정(표본의 크기가 클 때)

<br/>

#### 10.2.2 표본의 크기 $n=48$, 표본평균 $\bar{x}=86.5$, 표본표준편차 $s=7.9$라고 할 때 모평균 $\mu$의 90% 신뢰구간을 구하라.

```{r}
n=48
x_bar=86.5
s=7.9

lowerbound = x_bar + qnorm(0.05) * s / sqrt(n)
upperbound = x_bar + qnorm(0.95) * s / sqrt(n)

cat("(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.4 한 연구자가 모평균의 90% 신뢰구간을 구한다고 하자. 그러한 작업을 200번 하였다고 하면 몇 개의 신뢰구간이 실제의 평균을 포함하고 있겠는가?

180개  
신뢰구간은 추정량의 분포를 이용하여 표본으로부터 모수 값을 포함하리라고 예상되는 구간을 구하여 제시하는 것이다.

<br/>

#### 10.2.6 한 자동차 공장에서 38명의 새로운 직원들이 2주 동안의 연수를 마친 후, 특정한 작업을 얼마나 빠른 시간 안에 해 내는지를 측정하였다. 그 작업을 끝내는 데 걸리는 시간의 평균과 표준편차가 각각 68초와 12초였다. 모든 직원들이 2주의 교육을 마쳤을 때 그 작업을 마치는 데 걸리는 시간의 평균값의 95% 신뢰구간을 구하라.

```{r}
n=38
x_bar=68
s=12

lowerbound = x_bar + qnorm(0.025) * s / sqrt(n)
upperbound = x_bar + qnorm(0.975) * s / sqrt(n)

cat("(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.8 비정규직 근로자 50명의 월급을 조사하였더니 평균이 88만 원이고, 표준편차가 10만 원이었다. 평균 월급에 대한 90% 신뢰구간을 구하라.

```{r}
n=50
x_bar=88
s=10

lowerbound = x_bar + qnorm(0.05) * s / sqrt(n)
upperbound = x_bar + qnorm(0.95) * s / sqrt(n)

cat("(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.10 한 엔지니어는 고속도로의 파손된 부분을 수리하는 데 쓰이는 새로운 혼합 시멘트가 굳기까지 걸리는 시간을 측정하려고 한다. 100군데의 파손된 부분을 수리하여 굳기까지의 시간을 조사해 보니, 표본의 평균과 표준편차가 각각 32분과 4분으로 조사되었다. 시멘트가 굳기까지의 평균시간($\mu$)에 대한 99% 신뢰구간을 구하라.

```{r}
n=100
x_bar=32
s=4

lowerbound = x_bar + qnorm(0.005) * s / sqrt(n)
upperbound = x_bar + qnorm(0.995) * s / sqrt(n)

cat("(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.12 어느 회사에서 생산된 전자레인지 65개를 임의로 뽑아 전자파의 양을 측정하여 $\bar{x}=0.11, s=0.06$을 얻었다. 모집단의 평균 전자파량의 95% 신뢰구간을 구하라.

```{r}
n=65
x_bar=0.11
s=0.06

lowerbound = x_bar + qnorm(0.025) * s / sqrt(n)
upperbound = x_bar + qnorm(0.975)* s / sqrt(n)

cat("(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.14 모집단으로부터 충분히 큰 표본을 뽑아 모평균($\mu$)에 대한 95%의 신뢰구간 (52.6, 58.2)를 얻었다. 다음을 계산하라.

##### (1) 모평균($\mu$)의 점추정치와 추정량의 표준오차를 구하라.

##### (2) 모평균($\mu$)에 대한 80% 신뢰구간을 계산하라.

```{r}
point = (52.6 + 58.2) / 2
se = (58.2 - point) / 1.96
lowerbound = point + qnorm(0.1) * se
upperbound = point + qnorm(0.9) * se

cat(" (1)", "점추정치:", point, ", 표준오차:", se, "\n", "(2)", "(", lowerbound, ",", upperbound, ")")
```

<br/>

#### 10.2.16 어떤 화학실험에서 구리 침전물량의 표준편차가 4.5g이라고 하자. 이때 모평균에 대한 표본평균의 오차가 1.86g 이하가 될 확률이 최소한 99%가 되도록 한다면 몇 번의 실험을 반복해야 하는가?

```{r}
s = 4.5
answer = (qnorm(0.995) * s / 1.86)^2

cat(ceiling(answer))
```

<br/>

#### 10.2.18 62명의 6세의 여자아이들을 임의로 뽑아 그들의 키에 대한 모평균의 95% 신뢰구간을 구하였더니 (107.2cm, 127.1cm)였다고 하자. 다음 물음에  "예", "아니오", 혹은 "알 수 없다"로 답하라.

##### (1) 표본평균이 (107.2, 127.1) 안에 있는가?

##### (2) 모평균이 (107.2, 127.1) 안에 있는가?

##### (3) 다시 62명의 6세 여자아이들의 표본을 추출한다면 이 표본의 평균이 (107.2, 127.1)의 구간 안에 있겠는가?

##### (4) 표본의 95%가 (107.2, 127.1)의 구간 안에 포함되는가?

##### (5) 같은 자료로부터 99%와 같이 더 높은 신뢰수준의 신뢰구간을 구한다면 그 구간이 (107.2, 127.1)보다 좁아지겠는가?

```{r}
cat(
  " (1)", "예", "\n", 
   "(2)", "알 수 없다", "\n", 
   "(3)", "알 수 없다", "\n", 
   "(4)", "아니오", "\n", 
   "(5)", "아니오"
)
```

<br/>
<br/>

### 10.3 모평균에 대한 검정(표본의 크기가 클 때)

<br/>

#### 10.3.6 검정통계량 Z를 계산하고, 주어진 유의수준 $\alpha$를 갖고 결론을 설명하라.

##### (1) $\bar{x}=30.54, \sigma=2, \mu>30, n=55, \alpha=0.05$

```{r}
x_bar=30.54
sigma=2
mu=30
n=55
alpha=0.05

z = (x_bar - mu) / (sigma/sqrt(n))
if (z > qnorm(0.95)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

cat("(1) 검정통계량z:", z, ",", message)

```

##### (2) $\bar{x}=0.142, \sigma=0.085, \mu<0.15, n=150, \alpha=0.025$

```{r}
x_bar=0.142
sigma=0.085
mu=0.15
n=150
alpha=0.025

z = (x_bar - mu) / (sigma/sqrt(n))
if (z < qnorm(alpha)) {
  message = sprintf("유의수준 %.3f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.3f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

cat("(2) 검정통계량z:", z, ",", message)

```

##### (3) $\bar{x}=72.35, \sigma=8.6, \mu \neq 75, n=38, \alpha=0.01$

```{r}
x_bar=72.35
sigma=8.6
mu=75
n=38
alpha=0.01

z = (x_bar - mu) / (sigma/sqrt(n))
if ((z < qnorm(alpha/2)) | (z > qnorm(1-alpha/2))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

cat("(3) 검정통계량z:", z, ",", message)

```

##### (4) $\bar{x}=-0.79, \sigma=1.62, \mu \neq 0, n=40, \alpha=0.06$

```{r}
x_bar=-0.79
sigma=1.62
mu=0
n=40
alpha=0.06

z = (x_bar - mu) / (sigma/sqrt(n))
if ((z < qnorm(alpha/2)) | (z > qnorm(1-alpha/2))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

cat("(4) 검정통계량z:", z, ",", message)

```

<br/>

#### 10.3.8 한 대학서점으로부터 임의로 추출한 40개의 영수증을 조사한 결과 표본평균 $\bar{x}=5$만 원, 표본표준편차 $s=9$천 원이라고 한다. 이 값들을 이용해서 한 번에 판매한 평균액수($\mu$)에 대한 가설 $H_0: \mu=46000$ 대 $H_1:\mu \neq 46000$을 유의수준 0.05에서 검정하라.

```{r}
x_bar=50000
s=9000
mu=46000
n=40
alpha=0.05

z = (x_bar - mu) / (s/sqrt(n))
if ((z < qnorm(alpha/2)) | (z > qnorm(1-alpha/2))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

cat("검정통계량z:", z, ",", message)

```

<br/>

#### 10.3.10 가설 $H_0: \mu=1100$ 대 $H_1:\mu \neq 1100$에 대한 검정을 하기 위하여 80개의 측정값으로 이루어진 표본을 얻었다. 표본평균과 표본표준편차는 각각 1,060과 210으로 나타났다.

##### (1) 유의수준 1%에서 가설검정을 시행하라.

##### (2) P-값을 계산하고 그 결과에 대하여 해석하라.

```{r}
x_bar=1060
s=210
mu=1100
n=80
alpha=0.01

z = (x_bar - mu) / (s/sqrt(n))
if ((z < qnorm(alpha/2)) | (z > qnorm(1-alpha/2))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = pnorm(z) * 2

cat(" (1)", message, "\n", "(2)", p_value)

```

<br/>

#### 10.3.12 새로운 치료법이 말기 암환자의 생명 연장에 기존의 치료보다 더 효과적이라는 주장이 있다. 기존의 치료는 오랫동안 사용되어 왔으며 의학 잡지의 기록에 의하여 평균 생존기간이 4.2년으로 알려지고 있다. 새로운 치료법을 80명의 환자들에게 시행하여 그들의 생존기간을 기록한 결과 표본평균과 표본표준편차는 각각 4.5년과 1.1년으로 밝혀졌다. 위의 주장은 이들 결과에 의해 뒷받침될 수 있는가? 유의수준 $\alpha=0.05$에서 검정하라. 또한 P-값도 계산하라.

```{r}
x_bar=4.5
s=1.1
mu=4.2
n=80
alpha=0.05

z = (x_bar - mu) / (s/sqrt(n))
if (z > qnorm(alpha)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = 1- pnorm(z)

cat(message, "\n", "P-값:", p_value)

```

<br/>

#### 10.3.16 한 회사에서는 땅콩, 호두, 마카다미아 등을 혼합하여 캔으로 판매하고 있는데 내용물의 25%가 값비싼 마카다미아라는 표지를 붙이고 있다고 한다. 이 표지가 과대선전일지도 모른다고 생각한 검사자가 35개의 캔을 임의로 추출하여 마카다미아의 혼합비율을 측정하였다. 이들 측정치들의 평균과 표준편차는 각각 23.5와 3.1로 밝혀졌다. 이들 결과들은 검사자의 신념을 지지할 수 있는 강한 증거를 제시하는가?

```{r}
x_bar=23.5
s=3.1
mu=25
n=35
alpha=0.05

z = (x_bar - mu) / (s/sqrt(n))
if (z < qnorm(alpha)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = pnorm(z)

cat(
  message, "\n", 
  "즉, 내용물의 25%가 값비싼 마카다미아라고 보기 힘들다.", "\n", 
  "P-값: ", p_value, sep = ""
)

```

<br/>

#### 10.3.18 다음의 물음에 답하라.

##### (1) 어느 회사에서 자회사 제품의 무게가 다른 회사 제품의 무게 50g보다 크다고 주장하고자 한다. 원하는 가설을 세워라.

##### (2) 실제로 이 회사 제품의 무게가 50g보다 크다면 검정에서 어떤 오류를 범할 수 있는가?

##### (3) 이 회사 제품의 무게에 대한 추론을 위하여 표본을 추출하려고 한다. 95% 신뢰구간의 길이가 1보다 작기를 원한다면 $\sigma=3$이라고 알려져 있을 때 표본의 크기는 얼마가 되어야 하는가?

##### (4) (1)에 대한 검정에서 $H_0$를 기각하였다. 어떤 오류를 범할 수 있는가?

```{r}
answer_1 = "H_0: mu=50 vs H_1: mu>50"

answer_2 = "제 2종 오류"

confidence = 0.975  # 주의! 0.95 가 아니라 0.975이다.
sigma=3
answer_3 = ceiling((2 * qnorm(confidence) * sigma )^2)

answer_4 = "제 1종 오류"

cat(
  " (1) ", answer_1, "\n", 
  "(2) ", answer_2, "\n", 
  "(3) ", answer_3, "\n", 
  "(4) ", answer_4 
)

```

<br/>

#### 10.3.20 표본의 크기가 64인 자료에 대하여 모평균이 65보다 작다는 주장을 검정하고자 한다. $\sigma=5$일 때 다음 물음에 답하라.

##### (1) 이 검정에 대한 기각역이 $R: \bar{X}\leq64$일 때, 제1종 오류를 범할 확률을 구하라.

##### (2) 이 검정에 대한 기각역이 $R: \bar{X}\leq64$이며 실제 모평균은 63.5일 때, 제2종 오류를 범할 확률을 구하라.

##### (3) 이 검정에 대한 기각역이 $R: \bar{X}\leq c$인 검정의 유의수준이 $\alpha=0.01$이 되도록 $c$를 구하라.

```{r}
n=64
mu_0=65
sigma=5
c = (64 - mu_0) / (sigma / sqrt(n))
answer_1 = pnorm(c)

n=64
mu_1=63.5
sigma=5
c = (64 - mu_1) / (sigma / sqrt(n))
answer_2 = 1 - pnorm(c)

n=64
mu_0=65
sigma=5
answer_3 = mu_0 + qnorm(0.01) * sigma / sqrt(n)

cat(
  " (1) ", answer_1, "\n", 
  "(2) ", answer_2, "\n", 
  "(3) ", answer_3
)

```

<br/>

### 10.4 모비율에 대한 추론(표본의 크기가 클 때)

<br/>

#### 10.4.2 모비율 $p$를 추정하기 위해 크기가 $n$인 표본이 임의추출되었고, 그 중 $X$개가 관심있는 성질을 가지고 있는 것으로 판명되었다고 하자. 다음의 각 경우에 대해서 모비율의 90% 신뢰구간을 구하라.

##### (1) $n=50$, $X=31$

##### (2) $n=460$, $X=52$ 

##### (3) $n=2500$, $X=1977$

```{r}
n=64
mu_0=65
sigma=5
c = (64 - mu_0) / (sigma / sqrt(n))
answer_1 = pnorm(c)

n=64
mu_1=63.5
sigma=5
c = (64 - mu_1) / (sigma / sqrt(n))
answer_2 = 1 - pnorm(c)

n=64
mu_0=65
sigma=5
answer_3 = mu_0 + qnorm(0.01) * sigma / sqrt(n)

cat(
  " (1) ", answer_1, "\n", 
  "(2) ", answer_2, "\n", 
  "(3) ", answer_3
)

```

<br/>

#### 10.4.4 어떤 사람이 A 상표 세제의 시장점유율을 조사한다고 하자. 즉 모든 상표들의 총 판매량에 대한 A 상표의 판매량의 비율을 조사하려고 한다. 그 사람은 몇 개의 상점으로부터 425 상자의 세제가 판매된 가운데 120 상자가 A 상표의 세제였다는 것을 알아냈다고 하자.

##### (1) A 상표 세제의 시장점유율을 추정하라.

##### (2) 표준오차를 추정하라.

##### (3) A 상표의 시장점유율에 대한 95% 신뢰구간을 구하라.

```{r}
p = 120 / 425
n = 425

answer_1 = p
answer_2 = sqrt(p * (1-p) / n)

lowerbound = p + qnorm(0.025) * answer_2
upperbound = p + qnorm(0.975) * answer_2

cat(
  " (1) ", answer_1, "\n", 
  "(2) ", answer_2, "\n", 
  "(3) ", "(", lowerbound, ",", upperbound, ")"
)
```

<br/>

#### 10.4.6 3년 동안 한 산업단지 내의 잣나무 중 90%가 죽은 것으로 밝혀졌다. 공해에 저항력이 강한 새로운 종이 현재 연구 중에 있는데, 첫 실험의 반응을 관찰한 결과, 같은 지역에서 3년 동안 새로운 종 45 개체의 묘목 중에 28 개체가 죽었다고 한다. 새로운 종의 3년간의 고사율을 추정하고 90% 신뢰구간을 구하라.

```{r}
p = 28 / 45
n = 45

lowerbound = p + qnorm(0.05) * sqrt(p * (1 - p) / n)
upperbound = p + qnorm(0.95) * sqrt(p * (1 - p) / n)

cat(
  " 고사율:", p,"\n",
  "90% 신뢰구간:",  "(", lowerbound, ",", upperbound, ")"
)
```

<br/>

#### 10.4.8 1988년에 졸업한 고등학생 중 전국에서 임의로 750명을 대상으로 실시한 설문조사에서 59.8%가 대학에 진학하였고, 4.2%가 직업훈련소에 입소한 반면, 36%는 더 이상의 교육을 받지 못하였다는 결과가 나왔다.

##### (1) 1988년에 졸업한 고등학생 중 대학에 진학한 학생의 모비율에 대한 95% 신뢰구간을 구하라.

##### (2) 1988년에 졸업한 고등학생 중 직업훈련소에 입소한 고등학생의 모비율에 대한 90% 신뢰구간을 구하라.

```{r}
n = 750
p_1 = 0.598
p_2 = 0.042

lowerbound_1 = p_1 + qnorm(0.025) * sqrt(p_1 * (1 - p_1) / n)
upperbound_1 = p_1 + qnorm(0.975) * sqrt(p_1 * (1 - p_1) / n)
answer_1 = paste("(", lowerbound_1, ",", upperbound_1, ")")

lowerbound_2 = p_2 + qnorm(0.05) * sqrt(p_2 * (1 - p_2) / n)
upperbound_2 = p_2 + qnorm(0.95) * sqrt(p_2 * (1 - p_2) / n)
answer_2 = paste("(", lowerbound_2, ",", upperbound_2, ")")

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```






