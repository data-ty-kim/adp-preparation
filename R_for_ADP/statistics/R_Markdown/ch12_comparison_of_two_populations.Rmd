---
title: "12장 두 모집단의 비교"
author: "Taeyoon Kim"
date: "2024-11-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<br/>

### 12.2 두 개의 독립 표본 

<br/>

#### 12.2.2 한자능력검정시험에서의 점수를 근거로 하여 도시 A, B 의 학생들을 비교하였다. 중학교 1학년의 A 도시 학생 90명과 B 도시 학생 100명의 표본으로부터 구한 대회 점수에 대한 통계량 값이 자료와 같다. 두 도시 간의 모평균 점수의 차에 대한 98% 신뢰구간을 구하라.

```{r}
data = read.csv("../Data/exercise_12_2_02.csv", row.names = 1)

x_bar = data['평균', 'A']
y_bar = data['평균', 'B']
s_1 = data['표준편차', 'A']
s_2 = data['표준편차', 'B']
n_1 = data['표본크기', 'A']
n_2 = data['표본크기', 'B']

lowerbound = (x_bar - y_bar) + qnorm(p=0.01) * sqrt(s_1^2/n_1 + s_2^2/n_2)
upperbound = (x_bar - y_bar) + qnorm(p=0.99) * sqrt(s_1^2/n_1 + s_2^2/n_2)
answer = paste("(", lowerbound, ",", upperbound, ")")

cat(answer)
```

<br/>

#### 12.2.4 두 개의 처리를 비교하기 위한 실험에 141개의 실험재료를 사용하였다. 79개의 실험재료를 임의로 추출하여 처리 1을 행하고 나머지 62개의 실험재료에 대하여 처리 2를 행하였다. 두 처리에 대한 반응의 평균과 표준편차는 자료와 같다. 처리효과의 평균의 차에 대한 98% 신뢰구간을 구하라.

```{r}
data = read.csv("../Data/exercise_12_2_04.csv", row.names = 1)

x_bar = data['평균', '처리1']
y_bar = data['평균', '처리2']
s_1 = data['표준편차', '처리1']
s_2 = data['표준편차', '처리2']
n_1 = 79
n_2 = 62

lowerbound = (x_bar - y_bar) + qnorm(p=0.01) * sqrt(s_1^2/n_1 + s_2^2/n_2)
upperbound = (x_bar - y_bar) + qnorm(p=0.99) * sqrt(s_1^2/n_1 + s_2^2/n_2)
answer = paste("(", lowerbound, ",", upperbound, ")")

cat(answer)

```

<br/>

#### 12.2.6 어린이 성장과 사회환경에 관한 연구의 한 분야로서 부모가 고등교육을 받지 못한 1학년생(집단1)과 부모가 대학교육을 받은 1학년생(집단2)의 언어능력의 비교에 대한 연구가 이루어졌다. 집단1과 집단2로부터 각각 66명, 38명의 어린이를 임의로 뽑아서 그들의 언어능력을 점수로 계산한 통계량이 자료와 같다,

##### (1) 두 집단 간 언어능력의 차이가 있는가? (유의수준 $\alpha=0.01$로 검정하라.)

##### (2) 두 어린이 집단의 모평균 점수차에 대한 98% 신뢰구간을 계산하라.

```{r}
data = read.csv("../Data/exercise_12_2_06.csv", row.names = 1)

x_bar = data['평균', '집단1']
y_bar = data['평균', '집단2']
s_1 = data['표준편차', '집단1']
s_2 = data['표준편차', '집단2']
n_1 = 66
n_2 = 38
alpha = 0.01

z = ((x_bar - y_bar) - 0) / sqrt(s_1^2/n_1 + s_2^2/n_2)

if ((z < qnorm(alpha/2)) | (z > qnorm(1 - alpha/2))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

if (z < 0) {
  p_value = pnorm(q=z)
} else {
  p_value = 1 - pnorm(q=z)
}

answer_1 = paste(
  "검정통계량 z가", round(z, 4), "이고, p-value가", 
  round(p_value, 4), "이므로,\n   ", message
)

lowerbound = (x_bar - y_bar) + qnorm(0.01) * sqrt(s_1^2/n_1 + s_2^2/n_2)
upperbound = (x_bar - y_bar) + qnorm(0.99) * sqrt(s_1^2/n_1 + s_2^2/n_2)

answer_2 = paste("(", lowerbound, ",", upperbound, ")")

cat("(1)", answer_1, "\n(2)", answer_2)
```

<br/>

#### 12.2.8 국내 고용평등추진위원회는 여성 고용인에 대한 임금이 같은 처지의 남성 고용인의 임금만큼 지급되는지에 대한 조사를 실시하였다. 하급사원에서 남성 75명, 여성 64명을 임의로 뽑아서 그들의 임금 자료로부터 자료와 같은 값을 얻었다.

##### (1) 남녀 하급사원의 평균임금의 차에 대한 95% 신뢰구간을 구하라. 

##### (2) **(1)**에서 구한 신뢰구간을 참조하여 평균임금이 같다는 귀무가설에 대하여 남성의 임금이 더 높다고 할 수 있는지 검정하고자 한다. 유의수준 $\alpha=0.05$로 가설검정에 대한 결론을 내려라.

```{r}
data = read.csv("../Data/exercise_12_2_07.csv", row.names = 1)

x_bar = data['평균', '남성']
y_bar = data['평균', '여성']
s_1 = data['표준편차', '남성']
s_2 = data['표준편차', '여성']
n_1 = 75
n_2 = 64
alpha = 0.05

lowerbound = (x_bar - y_bar) + qnorm(alpha/2) * sqrt(s_1^2/n_1 + s_2^2/n_2)
upperbound = (x_bar - y_bar) + qnorm(1-alpha/2) * sqrt(s_1^2/n_1 + s_2^2/n_2)

answer_1 = paste("(", lowerbound, ",", upperbound, ")")

z = ((x_bar - y_bar) - 0) / sqrt(s_1^2/n_1 + s_2^2/n_2)

if ((z > qnorm(1-alpha))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = 1 - pnorm(q=z)

answer_2 = paste(
  "검정통계량 z가", round(z, 4), "이고, p-value가", 
  round(p_value, 4), "이므로,\n   ", message
)

cat("(1)", answer_1, "\n(2)", answer_2)
```

<br/>

#### 12.2.10 섬세함을 요구하는 어느 작업에서 성별에 따라 작업하는 데 걸리는 시간이 차이가 있는지 판단하고자 48명의 남성을 대상으로 작업시간을 조사한 결과 평균 7.92분, 표준편차 3.45분이고, 38명 여성의 작업시간은 평균 5.80분, 표준편차 2.87분이었다. 여성보다 남성이 작업하는 데 시간이 오래 걸린다고 할 수 있는지 검정하라. (P-값을 이용하여 답하라.)

```{r}
x_bar = 7.92
y_bar = 5.80
s_1 = 3.45
s_2 = 2.87
n_1 = 48
n_2 = 38
alpha = 0.05

z = ((x_bar - y_bar) - 0) / sqrt(s_1^2/n_1 + s_2^2/n_2)

if ((z > qnorm(1-alpha))) {  # 주의! 여성보다 남성이 오래 걸리는 거다!
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = 1 - pnorm(q=z)

answer = paste(
  " 검정통계량 z가", round(z, 4), "이고, p-value가", 
  round(p_value, 4), "이므로,\n", message
)

cat(answer)
```

<br/>

#### 12.2.12 두 개의 모집단에서 얻은 서로 독립인 표본에 대한 통계량이 자료와 같이 주어졌다. 필요한 가정이 있으면 기술하고 다음에 답하라.

##### (1) $(\mu_1 - \mu_2)$에 대한 95% 신뢰구간을 구하라.

##### (2) 가설 $H_0: \mu_1 - \mu_2 = 10$ 대 $H_0: \mu_1 - \mu_2 > 10$에 대한 검정을 하라. ($\alpha=0.01$)


```{r}
data = read.csv("../Data/exercise_12_2_12.csv", row.names = 1)

x_bar = data['mean', '표본1']
y_bar = data['mean', '표본2']
s_1 = data['sd', '표본1']
s_2 = data['sd', '표본2']
n_1 = data['n', '표본1']
n_2 = data['n', '표본2']
s_p = sqrt(((n_1 - 1) * s_1^2 + (n_2 - 1) * s_2^2) / (n_1 + n_2 - 2))
alpha = 0.01

lowerbound = (x_bar-y_bar) + qt(0.05/2, df=n_1 + n_2 -2) * s_p * sqrt(1/n_1 + 1/n_2)
upperbound = (x_bar-y_bar) + qt(1-0.05/2, df=n_1 + n_2 -2) * s_p * sqrt(1/n_1 + 1/n_2)

answer_1 = paste("(", lowerbound, ",", upperbound, ")")

t = ((x_bar - y_bar) - 10) / (s_p * sqrt(1/n_1 + 1/n_2))

if (t > qt(1-alpha, df = n_1 + n_2 - 2)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = 1 - pt(q=t, df = n_1 + n_2 - 2)

answer_2 = paste(
  "검정통계량 t가", round(t, 4), "이고, p-value가", 
  round(p_value, 4), "이므로,\n   ", message
)

cat("가정: 두 모집단이 정규분포를 따르고 두 모표준편차가 같다고 하자.", "\n(1)", answer_1, "\n(2)", answer_2)
```

<br/>

#### 12.2.14 두 모집단으로부터 서로 독립인 표본들에 대하여 자료와 같은 통계량이 주어졌다. 필요한 가정이 있으면 기술하고 다음에 답하라.

##### (1) $(\mu_1 - \mu_2)$에 대한 98% 신뢰구간을 구하라.

##### (2) 가설 $H_0: \mu_1 - \mu_2 = 20$ 대 $H_0: \mu_1 - \mu_2 < 20$에 대한 검정을 하라. ($\alpha=0.025$)

```{r}
data = read.csv("../Data/exercise_12_2_14.csv", row.names = 1)

x_bar = data['mean', '표본1']
y_bar = data['mean', '표본2']
s_1 = data['sd', '표본1']
s_2 = data['sd', '표본2']
n_1 = data['n', '표본1']
n_2 = data['n', '표본2']

if ((s_1 / s_2 < 1/2) | (s_1 / s_2 > 2)) {
  assumption = "가정: 두 모집단이 정규분포를 따르지만 두 모표준편차가 다르다고 하자."
} else {
  assumption = "가정: 두 모집단이 정규분포를 따르고 두 모표준편차가 같다고 하자."
}

lowerbound = (x_bar - y_bar) + qt(0.01, df=min(n_1-1, n_2-1)) * sqrt(s_1^2/n_1 + s_2^2/n_2)
upperbound = (x_bar - y_bar) + qt(0.99, df=min(n_1-1, n_2-1)) * sqrt(s_1^2/n_1 + s_2^2/n_2)

answer_1 = paste("(", lowerbound, ",", upperbound, ")")

t = ((x_bar - y_bar) - 20) / sqrt(s_1^2/n_1 + s_2^2/n_2)
alpha = 0.025

if (t < qt(p=alpha, df=min(n_1-1, n_2-1))) {
  message = sprintf("유의수준 %.3f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.3f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = 1 - pt(t, df = min(n_1-1, n_2-1))

answer_2 = paste(
  "검정통계량 t가", round(t, 4), "이고, p-value가", 
  round(p_value, 4), "이므로,\n   ", message
)

cat(assumption, "\n(1)", answer_1, "\n(2)", answer_2)
```

<br/>

#### 12.2.16 정신분석가들은 아동학대와 범죄행위 간의 관련성에 대하여 오랫동안 연구를 해왔다. 유년시절에 학대들 받은 52명의 소년들과 학대 받지 않은 67명의 소년들에 대한 연구에서 그들이 십대에 일으킨 범죄행위의 건수에 관한 자료는 자료와 같다. 학대 받은 집단의 범죄행위의 평균 건수가 더 높다고 할 수 있는가? (P-값을 계산하여 답하라.)

```{r}
data = read.csv("../Data/exercise_12_2_16.csv", row.names = 1)

x_bar = data["mean", "abused"]
y_bar = data["mean", "not_abused"]
s_1 = data["sd", "abused"]
s_2 = data["sd", "not_abused"]
n_1 = 52
n_2 = 67
alpha=0.05
z = ((x_bar - y_bar) - 0) / sqrt(s_1^2/n_1 + s_2^2/n_2)

if (z > qnorm(alpha)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = 1 - pnorm(z)

answer = paste(
  " 검정통계량 z가", round(z, 4), "이고, p-value가", 
  round(p_value, 4), "이므로,\n", message
)

cat(answer)
```

<br/>

#### 12.2.18 사람이 격렬한 운동을 할 때에 필요한 단위 체중당 산소흡입량(산소흡입력)은 노동능력의 측도가 된다. 페루의 고지대에 살고 있는 20명의 원주민으로 구성된 집단 1과 성인이 되어서 고지대 환경에 적응된 저지대인 10명으로 구성된 집단 2의 산소흡입력 비교를 위해서 두 집단을 측정하였으며 기록된 자료의 통계량 값이 계산되었다. 

##### (1) 두 집단 간 평균 산소흡입력의 차에 대한 98% 신뢰구간을 구하라.

##### (2) 제시된 자료는 고지대의 원주민과 고지대에 적응된 저지대인의 평균 산소흡입력 차이에 대한 증거를 제시하는가?

```{r}
data = read.csv("../Data/exercise_12_2_18.csv", row.names = 1)

x_bar = data["mean", "group_1"]
y_bar = data["mean", "group_2"]
s_1 = data["sd", "group_1"]
s_2 = data["sd", "group_2"]
n_1 = 20
n_2 = 10
s_p = sqrt(((n_1 - 1) * s_1^2 + (n_2 - 1) * s_2^2) / (n_1 + n_2 - 2))

lowerbound = (x_bar - y_bar) + qt(0.01, df=n_1 + n_2 - 2) * s_p * sqrt(1/n_1 + 1/n_2)
upperbound = (x_bar - y_bar) + qt(0.99, df=n_1 + n_2 - 2) * s_p * sqrt(1/n_1 + 1/n_2)

answer_1 = paste("(", lowerbound, ",", upperbound, ")")

t = ((x_bar - y_bar) - 0) / (s_p * sqrt(1/n_1 + 1/n_2))
alpha = 0.05

if ((t < qt(alpha/2, df = n_1 + n_2 - 2)) | (t > qt(1-alpha/2, df = n_1 + n_2 - 2))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

if (t < 0) {
  p_value = pt(t, df = n_1 + n_2 - 2)
} else {
  p_value = 1 - pt(t, df = n_1 + n_2 - 2)
}

answer_2 = paste(
  "검정통계량 t가", round(t, 4), "이고, p-value가", 
  round(p_value, 4), "이므로,\n   ", message, "따라서 차이가 존재한다."
)

cat("(1)", answer_1, "\n(2)", answer_2)
```

<br/>

#### 12.2.20 공장 노동자들이 숙련작업을 수행하기 위해 교육받는 2개의 프로그램을 비교하기 위해 20명의 노동자들이 실험에 임하였다. 그들 중 10명을 임의로 뽑아서 방법1에 의해 교육을 받게 하고 나머지 10명은 방법2에 의해 교육을 받게 하였다. 교육을 끝내고 난 후 모든 노동자들을 대상으로 숙련작업 수행에 필요한 시간을 측정하여 자료를 얻었다. (단위: 분)

##### (1) 이들 자료로부터 방법1의 교육을 받은 후의 평균 작업 시간이 방법 2보다 적다고 할 수 있는가?

##### (2) 모집단에 대한 필요한 가정이 있으면 기술하라.

##### (3) 두 방법 사이에 작업 시간의 모평균 차에 대한 95% 신뢰구간을 구하라.

```{r}
data = read.csv("../Data/exercise_12_2_20.csv")

x_bar = mean(data[,"method_1"])
y_bar = mean(data[,"method_2"])
s_1 = sd(data[,"method_1"])
s_2 = sd(data[,"method_2"])
n_1 = length(data[,"method_1"])
n_2 = length(data[,"method_2"])
s_p = sqrt(((n_1 - 1) * s_1^2 + (n_2 - 1) * s_2^2) / (n_1 + n_2 - 2))
alpha = 0.05

t = ((x_bar - y_bar) - 0) / (s_p * sqrt(1/n_1 + 1/n_2))

if (t < qt(alpha, df = n_1 + n_2 - 2)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = pt(t, df = n_1 + n_2 - 2)

answer_1 = paste(
  "검정통계량 t가", round(t, 4), "이고, p-value가", 
  round(p_value, 4), "이므로,\n   ", message
)

answer_2 = "가정: 두 모집단이 정규분포를 따르고 두 모표준편차가 같다고 하자."

lowerbound = (x_bar - y_bar) + qt(alpha/2, df=n_1+n_2-2) * s_p * sqrt(1/n_1 + 1/n_2)
upperbound = (x_bar - y_bar) + qt(1-alpha/2, df=n_1+n_2-2) * s_p * sqrt(1/n_1 + 1/n_2)

answer_3 = paste("(", lowerbound, ",", upperbound, ")")

cat("(1)", answer_1, "\n(2)", answer_2, "\n(3)", answer_3)
```

<br/>

#### 12.2.22 성장 호르몬 투약이 새끼를 밴 쥐의 체중 증가에 미치는 영향에 대하여 조사를 하였다. 6마리의 정상인 쥐(집단1)와 성장 호르몬을 주입한 6마리 쥐(집단2)에 대하여 체중 증가에 대한 자료와 같은 통계량 값이주어졌다. 모집단에 대한 가정을 기술하고, 호르몬 투약을 한 쥐가 정상인 쥐보다 평균 체중 증가가 크다고 할 수 있는지에 대한 가설을 검정하라.

```{r}
data = read.csv("../Data/exercise_12_2_22.csv", row.names = 1)

assumption = " 가정: 두 모집단이 정규분포를 따르지만 두 모표준편차가 다르다고 하자."
x_bar = data["mean", "group_1"]
y_bar = data["mean", "group_2"]
s_1 = data["sd", "group_1"]
s_2 = data["sd", "group_2"]
n_1 = 6
n_2 = 6
alpha = 0.05

t = ((x_bar - y_bar) - 0) / sqrt(s_1^2/n_1 + s_2^2/n_2)

if (t < qt(alpha, df=min(n_1-1, n_2-1))) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = pt(t, df = min(n_1-1, n_2-1))

answer = paste(
  "검정통계량 t가", round(t, 4), "이고, p-value가", 
  round(p_value, 4), "이므로,\n", message
)

cat(assumption, "\n", answer)
```

<br/>

#### 12.2.24 두 모집단으로부터 서로 독립인 두 개의 표본에 대한 통계량들이 자료와 같이 4번 주어졌다. 각 경우에 모평균의 차에 대한 98% 신뢰구간을 구하고 실험에 필요한 가정을 말하라.

```{r}
data = read.csv("../Data/exercise_12_2_24.csv", row.names = 1)

# 1번 풀이
x_bar = data["(1) mean", "group_1"]
y_bar = data["(1) mean", "group_2"]
s_1 = data["(1) sd", "group_1"]
s_2 = data["(1) sd", "group_2"]
n_1 = data["(1) n", "group_2"]
n_2 = data["(1) n", "group_2"]
s_p = sqrt(((n_1 - 1) * s_1^2 + (n_2 - 1) * s_2^2) / (n_1 + n_2 - 2))
lowerbound = (x_bar - y_bar) + qt(0.01, df=n_1 + n_2 - 2) * s_p * sqrt(1/n_1 + 1/n_2)
upperbound = (x_bar - y_bar) + qt(0.99, df=n_1 + n_2 - 2) * s_p * sqrt(1/n_1 + 1/n_2)
answer_1 = paste("(", lowerbound, ",", upperbound, ")")

# 2번 풀이
x_bar = data["(2) mean", "group_1"]
y_bar = data["(2) mean", "group_2"]
s_1 = data["(2) sd", "group_1"]
s_2 = data["(2) sd", "group_2"]
n_1 = data["(2) n", "group_2"]
n_2 = data["(2) n", "group_2"]
lowerbound = (x_bar - y_bar) + qnorm(0.01) * sqrt(s_1^2/n_1 + s_2^2/n_2)
upperbound = (x_bar - y_bar) + qnorm(0.99) * sqrt(s_1^2/n_1 + s_2^2/n_2)
answer_2 = paste("(", lowerbound, ",", upperbound, ")")

# 3번 풀이
x_bar = data["(3) mean", "group_1"]
y_bar = data["(3) mean", "group_2"]
s_1 = data["(3) sd", "group_1"]
s_2 = data["(3) sd", "group_2"]
n_1 = data["(3) n", "group_2"]
n_2 = data["(3) n", "group_2"]
lowerbound = (x_bar - y_bar) + qt(0.01, df=min(n_1-1, n_2-1)) * sqrt(s_1^2/n_1 + s_2^2/n_2)
upperbound = (x_bar - y_bar) + qt(0.99, df=min(n_1-1, n_2-1)) * sqrt(s_1^2/n_1 + s_2^2/n_2)
answer_3 = paste("(", lowerbound, ",", upperbound, ")")

# 4번 풀이
x_bar = data["(4) mean", "group_1"]
y_bar = data["(4) mean", "group_2"]
s_1 = data["(4) sd", "group_1"]
s_2 = data["(4) sd", "group_2"]
n_1 = data["(4) n", "group_2"]
n_2 = data["(4) n", "group_2"]
lowerbound = (x_bar - y_bar) + qnorm(0.01) * sqrt(s_1^2/n_1 + s_2^2/n_2)
upperbound = (x_bar - y_bar) + qnorm(0.99) * sqrt(s_1^2/n_1 + s_2^2/n_2)
answer_4 = paste("(", lowerbound, ",", upperbound, ")")

cat(
  "(1) 가정: 두 모집단이 정규분포를 따르고 두 모표준편차가 같다고 하자.", 
  "\n   ", answer_1, "\n(2)", answer_2,
  "\n(3) 가정: 두 모집단이 정규분포를 따르지만 두 모표준편차가 다르다고 하자.", 
  "\n   ", answer_3, "\n(4)", answer_4
)

```

<br/>

### 12.3 짝비교 

<br/>

#### 12.3.2 자료와 같이 짝이 이루어져 있다고 하자.

##### (1) 통계량 $t = \frac{\bar{D}}{s_D / \sqrt(n)}$ 의 값을 계산하라.

##### (2) 위의 $t$ 분포의 자유도는 얼마인가?

```{r}
data = read.csv("../Data/exercise_12_3_02.csv")

data$d = data$x - data$y
d_bar = mean(data$d)
s_d = sd(data$d)

answer_1 = d_bar / (s_d / sqrt(length(data$d)))
answer_2 = nrow(data) - 1

cat("(1)", answer_1, "\n(2)", answer_2)
```

<br/>

#### 12.3.6 어떤 영양학자는 사이크로트롭스(PC)라고 불리는 일종의 박테리아를 넣은 탈지유와 PC를 넣지 않은 탈지유로 만들어진 요구르트 질에 차가 있는지를 연구하고자 한다. 탈지유의 표본을 7곳의 우유 농장에서 채취한 후, 각각 절반의 우유에는 PC를 주입하고 나머지 절반의 우유에는 PC를 주입하지 않았다. 이렇게 얻어진 우유로 요구르트를 만들어 각각 응고된 정도를 측정하여 기록하였더니 결과가 자료와 같았다. (수치가 큰 것이 응고 정도가 강함을 나타낸다고 하자.) 자료로부터 PC가 주입된 우유로 만든 요구르트의 응고 정도가 더 강하다고 결론을 내릴 수 있겠는가? ($\alpha=0.05$로 검정하라.)


```{r}
data = read.csv("../Data/exercise_12_3_06.csv", row.names = 1)

data$d = data$PC_added - data$PC_not_added
d_bar = mean(data$d)
s_d = sd(data$d)
n = length(data$d)
alpha = 0.05

t = d_bar / (s_d / sqrt(n))

if (t > qt(p=1-alpha, df=n-1)) {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각한다.", alpha)
} else {
  message = sprintf("유의수준 %.2f 하에서 귀무가설을 기각할 수 없다.", alpha)
}

p_value = 1 - pt(t, df=n-1)

answer = paste(
  " 검정통계량 t가", round(t, 4), "이고, p-value가", 
  round(p_value, 4), "이므로,\n", message
)

cat(answer)
```

<br/>

#### 12.3.8 통조림 공장에서 통조림을 제조하기 전에 많은 양의 끓는 물로 채소를 세척하고 있다. 그런데 새로 개발된 방법인 증기를 이용한 세척방법(SBP)을 사용하면 채소에 들어 있는 비타민과 미네랄이 기존의 방법보다 적게 손실된다고 한다. 10곳의 농장에서 얻은 10다발의 콩을 가지고 SBP 방법과 기존의 방법을 비교하고자 한다. 각 다발의 콩 중에서 반은 기존의 방법으로, 나머지 반은 SBP 방법으로 처리한 후 통조림 된 콩에서 450g당 비타민의 양을 측정하였다. 두 가지 방법을 사용하였을 때 450g당 비타민 양의 평균차에 대한 98% 신뢰구간을 구하라.

```{r}
data = read.csv("../Data/exercise_12_3_08.csv")

data$d = data$SBP - data$not_SBP 
d_bar = mean(data$d)
s_d = sd(data$d)
n = length(data$d)

lowerbound = d_bar + qt(0.01, df=n-1) * s_d / sqrt(n)
upperbound = d_bar + qt(0.99, df=n-1) * s_d / sqrt(n)

answer = paste("(", lowerbound, ",", upperbound, ")")
cat(answer)
```










