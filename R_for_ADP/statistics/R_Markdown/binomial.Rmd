---
title: "R for ADP Statistics"
author: "Taeyoon Kim"
date: "2023-12-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<br/>

## 7장 이항분포와 그에 관련된 분포들

### 7.3 이항분포

<br/>

#### 3.4 이항분포에 관한 다음 물음에 답하라.

##### (3) $n=5$에 대하여 $p=0.2, 0.5, 0.8$인 이항분포 각각에 대해 $P[X\geq4]$를 구하라.

```{r}
a = 1 - pbinom(q=3, size=5, prob=0.2)  # 3번 이하
b = 1 - pbinom(q=3, size=5, prob=0.5)
c = 1 - pbinom(q=3, size=5, prob=0.8)

print(paste(round(a, 4), ',', b, ',', round(c, 4)))
```

<br/>

#### 3.6 확률변수 $X$가 이항분포를 따르고 $n=5, p=0.35$일 때, $X$의 최빈값(mode)을 구하라.

```{r fig.width=4, fig.height=3.5}
data = rbinom(n=10000, size=5, prob=0.35)
barplot(table(data), space=0)             # 최빈값은 2
```

<br/>

#### 3.8 $n=6, p=2/3$인 이항분포에서 다음의 확률을 계산하라.

##### (1) 4번 미만으로 성공한다.

##### (2) 4번 이상 성공한다.

##### (3) 5번 이하, 2번 이상 성공한다.

```{r}
n=6
p=2/3

answer_1 = pbinom(q=3, size=n, prob=p)  # 4번 미만
answer_2 = 1 - pbinom(q=3, size=n, prob=p)  # 4번 이상
answer_3 = pbinom(q=5, size=n, prob=p) - pbinom(q=1, size=n, prob=p)  # 2~5번

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>

#### 3.10 미국의 백인 중 85%가 Rh+의 혈액형을 가지고 있다고 한다. 이 중에서 7명을 임의로 선택하였을 때 다음의 확률을 구하라.

##### (1) 적어도 5명이 Rh+의 혈액형을 가지고 있다.

##### (2) 많아야 3명이 Rh-(Rh+가 없는 것)의 혈액형을 가지고 있다.

```{r}
n=7
p=0.85
answer_1 = 1 - pbinom(q=4, size=n, prob=p)
answer_2 = pbinom(q=3, size=n, prob=1-p)

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 3.12 이항분포를 이용하여 다음의 확률을 구하라.

##### (1) $p=0.7$일 때, 9번의 시행 중 5번 이하 성공할 확률

##### (2) $p=0.6$일 때, 16번의 시행 중 6번 이상 11번 이하 성공할 확률

##### (3) $p=0.3$일 때, 20번의 시행 중 30%가 성공일 확률

```{r}
n=c(9, 16, 20)
p=c(0.7, 0.6, 0.3)
answer_1 = pbinom(q=5, size=n[1], prob=p[1])
answer_2 = pbinom(q=11, size=n[2], prob=p[2]) - pbinom(q=5, size=n[2], prob=p[2])
answer_3 = dbinom(x=6, size=n[3], prob=p[3])

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>

#### 3.14 조사결과 70%의 성인 여성이 2년 동안에 적어도 1번 내과를 찾는다고 할 때, 19명의 성인 여성이 임의로 추출되었다고 하자. 다음의 확률을 구하라.

##### (1) 14명 미만이 내과를 찾았을 확률

##### (2) 적어도 17명이 내과를 찾았을 확률

```{r}
n=19
p=0.7
answer_1 = pbinom(q=13, size=n, prob=p)
answer_2 = 1 - pbinom(q=16, size=n, prob=p)

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 3.18 20%의 3학년 학생이 장학금을 받는다고 하자. 20명의 3학년 학생을 선택하였다.

##### (1) 많아야 3명의 학생이 장학금을 받을 확률은?

##### (2) 선택된 20명 중 장학금을 받을 사람의 기대 인원수와, 기대 인원수와 같은 수의 사람이 장학금을 받을 확률은?

```{r}
n=20
p=0.2
answer_1 = pbinom(q=3, size=n, prob=p)
answer_2 = dbinom(x=4, size=n, prob=p)

cat(" (1)", answer_1, "\n", "(2) 기대인원수: 4명, 확률:", answer_2)
```

<br/>

#### 3.22 유전법칙에 따르면 완두콩의 우성교배를 통한 자손은 네 가지 형태이고 각각의 비율이 둥글고 노란것, 쭈그러지고 노란 것, 둥글고 녹색인 것, 쭈그러지고 녹색인 것이 9:3:3:1이라고 한다.

##### (1) 확률변수 X를 130개의 우성교배 자손에서 둥글고 노란 것의 개수라고 할 때, X의 평균과 표준편차를 구하라.

##### (2) 확률변수 Y를 85개의 우성교배 자손에서 쭈그러지고 녹색인 것의 개수라고 할 때, Y의 평균과 표준편차를 구하라.

```{r}
n_x=130
n_y=85
p_x=9/16
p_y=1/16
answer_1 = c(n_x * p_x, sqrt(n_x * p_x * (1 - p_x)))
answer_2 = c(n_y * p_y, sqrt(n_y * p_y * (1 - p_y)))

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 3.24 이항분포에 대하여 다음 물음에 답하라.

##### (1) $n=80, p=0.35$일 때, 평균과 표준편차를 구하라.

##### (2) 평균이 60, 표준편차가 6일 때, $n$, $p$를 구하라.

```{r}
n=80
p=0.35
answer_1 = c(n * p, sqrt(n * p * (1 - p)))
answer_2 = c(60 / (1 - (6^2 / 60)), 1 - (6^2 / 60))

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 3.26 어떤 축구 선수의 페널티킥 성공률은 70%라고 하자. 이 선수가 어느 날 10번 성공할 때까지 페널티킥을 연습한다고 할 때, 12번 이상 시도해야 할 확률을 구하라.

```{r}
# 이항분포 풀이
answer = 1 - (0.7)^10 - dbinom(x=9, size=10, prob=0.7) * 0.7  
# 음이항분포 풀이
# answer = 1 - dnbinom(x=0, size=10, prob=0.7) - dnbinom(x=1, size=10, prob=0.7)

cat(" (1)", answer_1)
```
