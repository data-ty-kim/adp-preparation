---
title: "R for ADP Statistics"
author: "Taeyoon Kim"
date: "2023-12-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<br/>

## 7장 이항분포와 그에 관련된 분포들

### 7.3 이항분포

<br/>

#### 7.3.4 이항분포에 관한 다음 물음에 답하라.

##### (3) $n=5$에 대하여 $p=0.2, 0.5, 0.8$인 이항분포 각각에 대해 $P[X\geq4]$를 구하라.

```{r}
a = 1 - pbinom(q=3, size=5, prob=0.2)  # 3번 이하
b = 1 - pbinom(q=3, size=5, prob=0.5)
c = 1 - pbinom(q=3, size=5, prob=0.8)

print(paste(round(a, 4), ',', b, ',', round(c, 4)))
```

<br/>

#### 7.3.6 확률변수 $X$가 이항분포를 따르고 $n=5, p=0.35$일 때, $X$의 최빈값(mode)을 구하라.

```{r fig.width=4, fig.height=3.5}
data = rbinom(n=10000, size=5, prob=0.35)
barplot(table(data), space=0)             # 최빈값은 2
```

<br/>

#### 7.3.8 $n=6, p=2/3$인 이항분포에서 다음의 확률을 계산하라.

##### (1) 4번 미만으로 성공한다.

##### (2) 4번 이상 성공한다.

##### (3) 5번 이하, 2번 이상 성공한다.

```{r}
n=6
p=2/3

answer_1 = pbinom(q=3, size=n, prob=p)  # 4번 미만
answer_2 = 1 - pbinom(q=3, size=n, prob=p)  # 4번 이상
answer_3 = pbinom(q=5, size=n, prob=p) - pbinom(q=1, size=n, prob=p)  # 2~5번

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>

#### 7.3.10 미국의 백인 중 85%가 Rh+의 혈액형을 가지고 있다고 한다. 이 중에서 7명을 임의로 선택하였을 때 다음의 확률을 구하라.

##### (1) 적어도 5명이 Rh+의 혈액형을 가지고 있다.

##### (2) 많아야 3명이 Rh-(Rh+가 없는 것)의 혈액형을 가지고 있다.

```{r}
n=7
p=0.85
answer_1 = 1 - pbinom(q=4, size=n, prob=p)
answer_2 = pbinom(q=3, size=n, prob=1-p)

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.3.12 이항분포를 이용하여 다음의 확률을 구하라.

##### (1) $p=0.7$일 때, 9번의 시행 중 5번 이하 성공할 확률

##### (2) $p=0.6$일 때, 16번의 시행 중 6번 이상 11번 이하 성공할 확률

##### (3) $p=0.3$일 때, 20번의 시행 중 30%가 성공일 확률

```{r}
n=c(9, 16, 20)
p=c(0.7, 0.6, 0.3)
answer_1 = pbinom(q=5, size=n[1], prob=p[1])
answer_2 = pbinom(q=11, size=n[2], prob=p[2]) - pbinom(q=5, size=n[2], prob=p[2])
answer_3 = dbinom(x=6, size=n[3], prob=p[3])

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>

#### 7.3.14 조사결과 70%의 성인 여성이 2년 동안에 적어도 1번 내과를 찾는다고 할 때, 19명의 성인 여성이 임의로 추출되었다고 하자. 다음의 확률을 구하라.

##### (1) 14명 미만이 내과를 찾았을 확률

##### (2) 적어도 17명이 내과를 찾았을 확률

```{r}
n=19
p=0.7
answer_1 = pbinom(q=13, size=n, prob=p)
answer_2 = 1 - pbinom(q=16, size=n, prob=p)

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.3.18 20%의 3학년 학생이 장학금을 받는다고 하자. 20명의 3학년 학생을 선택하였다.

##### (1) 많아야 3명의 학생이 장학금을 받을 확률은?

##### (2) 선택된 20명 중 장학금을 받을 사람의 기대 인원수와, 기대 인원수와 같은 수의 사람이 장학금을 받을 확률은?

```{r}
n=20
p=0.2
answer_1 = pbinom(q=3, size=n, prob=p)
answer_2 = dbinom(x=4, size=n, prob=p)

cat(" (1)", answer_1, "\n", "(2) 기대인원수: 4명, 확률:", answer_2)
```

<br/>

#### 7.3.22 유전법칙에 따르면 완두콩의 우성교배를 통한 자손은 네 가지 형태이고 각각의 비율이 둥글고 노란것, 쭈그러지고 노란 것, 둥글고 녹색인 것, 쭈그러지고 녹색인 것이 9:3:3:1이라고 한다.

##### (1) 확률변수 X를 130개의 우성교배 자손에서 둥글고 노란 것의 개수라고 할 때, X의 평균과 표준편차를 구하라.

##### (2) 확률변수 Y를 85개의 우성교배 자손에서 쭈그러지고 녹색인 것의 개수라고 할 때, Y의 평균과 표준편차를 구하라.

```{r}
n_x=130
n_y=85
p_x=9/16
p_y=1/16
answer_1 = c(n_x * p_x, sqrt(n_x * p_x * (1 - p_x)))
answer_2 = c(n_y * p_y, sqrt(n_y * p_y * (1 - p_y)))

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.3.24 이항분포에 대하여 다음 물음에 답하라.

##### (1) $n=80, p=0.35$일 때, 평균과 표준편차를 구하라.

##### (2) 평균이 60, 표준편차가 6일 때, $n$, $p$를 구하라.

```{r}
n=80
p=0.35
answer_1 = c(n * p, sqrt(n * p * (1 - p)))
answer_2 = c(60 / (1 - (6^2 / 60)), 1 - (6^2 / 60))

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.3.26 어떤 축구 선수의 페널티킥 성공률은 70%라고 하자. 이 선수가 어느 날 10번 성공할 때까지 페널티킥을 연습한다고 할 때, 12번 이상 시도해야 할 확률을 구하라.

```{r}
# 이항분포 풀이
answer = 1 - (0.7)^10 - dbinom(x=9, size=10, prob=0.7) * 0.7  
# 음이항분포 풀이
# answer = 1 - dnbinom(x=0, size=10, prob=0.7) - dnbinom(x=1, size=10, prob=0.7)

cat(" (1)", answer_1)
```

<br/>

### 7.4 초기하분포

<br/>

#### 7.4.2 어느 회사에서 사원을 8명 모집하기 위해 신문에 광고를 내었더니 15 명의 남자와 8명의 여자가 지원하였다. 임의로 8명을 선택한다고 한다면 8명 중 여자가 3명 이상일 확률을 구하라. 예상되는 여자 신입사원은 몇 명이 되겠는가?

```{r}
n = 8
p = 8 / (15+8)
answer_1 = 1 - phyper(q=2, m=8, n=15, k=8) # help 설명 읽어보면 좋음
answer_2 = n*p

cat(" 여자가 3명 이상일 확률:", answer_1, "\n", "예상 여자 신입직원 수", answer_2)
```

<br/>

#### 7.4.6 어느 대학에서 전체 50명의 교수 중에서 5명을 뽑아 위원회를 구성하고자 한다. 선출 과정은 무작위이다. 통계학과에 6명의 교수가 있다고 하자.

##### (1) 위원회에 통계학과 교수가 한 사람도 없을 확률은?

##### (2) 적어도 1명 이상의 통계학과 교수가 포함될 확률은?

##### (3) 몇 명의 통계학과 교수가 포함되리라고 예상되는가?

```{r}
n = 5
p = 6 / 50
answer_1 = dhyper(x=0, m=6, n=44, k=5)
answer_2 = 1 - answer_1
answer_3 = n*p

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>


### 7.5 포아송분포

<br/>

#### 7.5.2 확률변수 X가 n=100, p=0.04인 이항분포를 따른다고 할 때, 포아송분포를 이용하여 다음의 근사확률을 계산하라.

##### $P[X\leq5], [X\geq7], [X=0]$

```{r}
m = 100 * 0.04
answer_1 = ppois(q = 5, lambda = m)
answer_2 = 1 - ppois(q = 6, lambda = m)
answer_3 = dpois(x=0, lambda = m)

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>

#### 7.5.4 어느 부동산 중개업소에서는 한 달에 평균 3건의 매매를 성사시킨다고 한다. 부동산의 매매가 계절의 영향을 받는다고 한다면 이는 포아송분포의 어느 성질을 위반하는 것인가?

(항상성 위배) 주어진 구간에서 사건의 평균 발생횟수의 확률분포는 구간의 시작점에는 관계가 없고 구간의 길이에만 영향을 받는다.   
※ 교재 212쪽 참고!

<br/>

#### 7.5.6 경부고속도로상의 어느 휴게소의 주유소는 평균적으로 5분에 6대 꼴로 차들이 기름을 넣으러 온다고 하자. 이때 어느 특정한 1분 동안 다음의 확률을 구하라.

##### (1) 2대 이하가 기름을 넣으러 온다.

##### (2) 2대 혹은 3대가 기름을 넣으러 온다.

##### (3) 3대 이상이 기름을 넣으러 온다.

```{r}
m = 6/5
answer_1 = ppois(q = 2, lambda = m)
answer_2 = dpois(x = 2, lambda = m) + dpois(x = 3, lambda = m)
answer_3 = 1 - answer_1

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>

#### 7.5.8 대학생의 94%가 휴대폰을 소유하고 있다고 한다. 대학생 100명에게 휴대폰이 있는지 없는지 알아본다고 할 때 그 중 휴대폰이 있는 사람이 90명 이하일 확률을 근사적으로 구하라.

```{r}
m = 94
answer = ppois(q = 90, lambda = m)

# p = 0.94
# n = 100
# answer_2 = pbinom(q=90, size=m, prob=p)


cat(answer)  # 이유는 모르겠는데 정답이랑 안 맞다. 정답은 0.084
```

<br/>


### 7.6 종합문제

<br/>

#### 7.6.4 시험에서 부정행위를 하다 발각될 확률이 0.2라고 한다. 3번의 부정행위시도에서 한 번도 발각되지 않을 확률은 얼마인가? 각각의 시도는 독립이다.

```{r}
p = 0.2
n = 3
answer = dbinom(x = 0, size = n, prob = p)

cat(answer) 
```

<br/>

#### 7.6.6 한 농구 팀의 공격 성공률이 40%라고 할 때, 첫 골이 3번째 공격에서 나올 확률은 얼마인가?

```{r}
answer = 0.6 * 0.6 * 0.4

cat(answer) 
```

<br/>

#### 7.6.8 어느 지역에 사는 40%의 사람의 혈액형이 O형이라고 한다. 이 지역에서 두 명을 임의로 선택하였을 때, 다음의 질문에 답하라.

##### (1) 적어도 한 명이 O형일 확률은 얼마인가?

##### (2) O형의 혈액형을 가진 사람 수의 기댓값은 얼마인가?

##### (3) 세 명을 임의로 선택하였을 때, (1)과 (2)의 질문에 다시 답하라.

```{r}
p = 0.4
n = 2
answer_1 = 1 - (0.6)^2
answer_2 = n * p
answer_3_1 = 1 -(0.6)^3 
answer_3_2 = 3 * p

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3_1, ",", answer_3_2)
```

<br/>

#### 7.6.10 유권자가 정치인에 대한 소문을 믿을 확률이 0.2라고 한다. 20명의 유권자가 정치인에 대한 소문을 들었다고 할 때 다음의 질문에 답하라.

##### (1) 아무도 소문을 믿지 않을 확률은 얼마인가?

##### (2) 7명 이상의 사람이 소문을 믿을 확률은 얼마인가?

##### (3) 소문을 믿는 사람의 수의 기댓값과 표준편차를 구하라.

```{r}
p = 0.2
n = 20
answer_1 = (1-p)^n
answer_2 = 1 - pbinom(q = 6, size = n, prob = p)
answer_3_1 = n*p 
answer_3_2 = sqrt(n*p*(1-p)) 

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3_1, ",", answer_3_2)
```

<br/>

#### 7.6.12 공정한 주사위를 4번 던질 때, 6의 눈이 2번 이하 나올 확률은 얼마인가?

```{r}
p = 1/6
n = 4
answer_1 = pbinom(q = 2, size = n, prob = p)

cat(answer_1)
```

<br/>

#### 7.6.16 이항분포를 이용하여 다음에 답하라.

##### (1) $n = 5$ 이고 $p = 0.4$ 인 이항분포의 히스토그램을 그려라.

##### (2) (1)의 기댓값과 분산을 구하라.

```{r fig.width=4, fig.height=3.5}
data = rbinom(n=10000, size=5, prob=0.4)
barplot(table(data), space=0)
```
```{r}
cat(' 기댓값: ', 5*0.4, '\n', '분산: ', 5*0.4*0.6)
```

<br/>

#### 7.6.18 이항분포를 이용하여 다음의 확률을 계산하라.

##### (1) $n=8$이고 $p=0.4$인 이항분포에서 3회 성공할 확률

##### (2) $n=16$이고 $p=0.6$인 이항분포에서 7회 실패할 확률

##### (3) $n=9$이고 $p=0.4$인 이항분포에서 3회 이하 성공할 확률

##### (4) $n=16$이고 $p=0.7$인 이항분포에서 13회 이상 성공할 확률

##### (5) $n=16$이고 $p=0.6$인 이항분포에서 8회 이상 13회 이하 성공할 확률

```{r}
answer_1 = dbinom(x = 3, size = 8, prob = 0.4)
answer_2 = dbinom(x = 7, size = 16, prob = 1 - 0.6)
answer_3 = pbinom(q = 3, size = 9, prob = 0.4)
answer_4 = 1 - pbinom(q = 12, size = 16, prob = 0.7)
answer_5 = pbinom(q = 13, size = 16, prob = 0.6) - pbinom(q = 7, size = 16, prob = 0.6)

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3, "\n", 
    "(4)", answer_4, "\n", "(5)", answer_5)
```

<br/>

#### 7.6.20 사회과학자가 주장하기를 대학교에 입학할 능력이 있는 실업계 고등학생 중 50%만이 대학에 진학한다고 한다. 만약 사회과학자의 주장이 맞다면 17명의 대학교에 입학할 능력이 있는 실업계 학생 중 10명이 대학교에 진학할 확률은 얼마인가? 또한 17명 중 대학교에 진학할 학생수의 기댓값은 얼마인가?

```{r}
n = 17
p = 0.5
answer_1 = dbinom(x = 10, size = n, prob = p)
answer_2 = n * p
cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.6.22 길동이는 자신이 초능력을 가지고 있다고 주장하고 있다. 이 주장을 확인하기 위해 5가지의 다른 그림이 그려진 카드를 준비하고 길동이의 눈을 가리고 5장의 카드 중 하나를 선택한 다음 5가지의 카드 중 어느 카드가 선택되었는지에 대해 물어보는 작업을 16회 실시하였다. 사실은 길동이는 초능력이 없고, 임의로 대답하였다고 하자.

##### (1) 카드가 무엇인지 맞추는 횟수가 3회 이하일 확률은 얼마인가?

##### (2) 카드가 무엇인지를 못 맞추는 횟수가 10회 이상일 확률은 얼마인가?

```{r}
n = 16
p = 1/5
answer_1 = pbinom(q = 3, size = n, prob = p)
answer_2 = pbinom(q = 6, size = n, prob = p)
cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.6.24 회원이 12명이 있는 동아리에서 6명은 특정 도시 출신 학생이다. 회원들 중 4명을 임의추출한다고 하였을 때, 4명 중 특정 도시 출신 학생의 수를 X라고 하자.

##### (2) 평균과 분산을 계산하라.

```{r}
answer_1 = 0 * choose(6,4) / choose(12,4) + 1 * choose(6,1) * choose(6,3) / choose(12,4) + 2 * choose(6,2) * choose(6,2) / choose(12,4)  + 3 * choose(6,3) * choose(6,1) / choose(12,4) + 4 * choose(6,4) / choose(12,4)
answer_2 = 0^2 * choose(6,4) / choose(12,4) + 1^2 * choose(6,1) * choose(6,3) / choose(12,4) + 2^2 * choose(6,2) * choose(6,2) / choose(12,4)  + 3^2 * choose(6,3) * choose(6,1) / choose(12,4) + 4^2 * choose(6,4) / choose(12,4)- answer_1^2
cat(" 평균", answer_1, "\n", "분산", answer_2)
```

<br/>

#### 7.6.26 어느 기업에 25명의 비서가 있는데 이 중 10명은 5년 이상 근무한 베테랑이라고 한다. 이 회사의 전무가 3명의 비서를 임의로 선발하여 새로운 업무에 투입하려고 한다. 이때 다음의 질문에 답하여라.

##### (1) 선발된 3명 중에 베테랑이 한 명도 없을 확률은 얼마인가?

##### (2) 2명의 베테랑이 선발될 확률은 얼마인가?

##### (3) 선발된 비서 중에 베테랑의 수를 X라고 할 때 X의 평균과 분산을 구하라.

```{r}
answer_1 = choose(15,3) / choose(25,3)
answer_2 = choose(15,1) * choose(10,2) / choose(25,3)
answer_3_1 = 0 * answer_1 + 1 * choose(15,2) * choose(10,1) / choose(25,3) + 2 * answer_2 + 3 * choose(10,3) / choose(25,3)
answer_3_2 = 0^2 * answer_1 + 1^2 * choose(15,2) * choose(10,1) / choose(25,3) + 2^2 * answer_2 + 3^2 * choose(10,3) / choose(25,3) - answer_3_1^2
cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3) 평균:", answer_3_1, '분산:', answer_3_2)
```

<br/>

#### 7.6.28 어느 자동차 보험회사의 경우 매일 평균적으로 5건의 배상을 해야 하는 사고가 발생한다. 다음의 확률을 계산하라.

##### (1) 어느 날 1건의 사고도 발생하지 않을 확률

##### (2) 5건 이상의 사고가 발생할 확률

```{r}
m = 5
answer_1 = dpois(x = 0, lambda = m)
answer_2 = 1 - ppois(q = 4, lambda = m)

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.6.30 어느 도시의 고등학생 중 3%만이 IQ가 130 이상이라고 한다. 50명의 학생을 임의추출하여 IQ 검사를 하였을 때, X를 IQ가 130 이상인 학생의 수라고 하자. 포아송 분포를 이용하여 확률 $X[X=0], P[X\geq3]$을 계산하라.

```{r}
m = 50 * 0.03
answer_1 = dpois(x = 0, lambda = m)
answer_2 = 1 - ppois(q = 2, lambda = m)

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.6.32 어떤 축구선수는 국가 간 A매치 경기에서 게임당 평균 0.12개의 골을 성공시키고 매 경기에서 같은 컨디션을 유지해서 k번 경기에서는 평균적으로 0.12k번 골을 성공시킨다고 한다.

##### (1) 이 선수가 출전하는 A매치 경기를 5번 관람한다고 할 때, 그 선수가 골 넣는 장면을 보게 될 확률은 얼마인가?

##### (2) 이 선수가 골 넣는 장면을 보게 될 확률이 90%를 넘으려면 최소한 몇 번의 A매치 경기를 관람해야 하겠는가?

```{r}
answer_1 = 1 - dpois(x = 0, lambda = 0.12 * 5)
answer_2 = dpois(x=0, lambda = 0.12*20)  # 이 경우 0.09071795가 나온다. 따라서 답이 20인데, 이렇게 구해야 하나?

cat(" (1)", answer_1, "\n", "(2)", "20번")
```
&nbsp;   
&nbsp;  
■ 7장 끝 - 2024.05.16.
