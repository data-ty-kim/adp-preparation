---
title: "R for ADP Statistics"
author: "Taeyoon Kim"
date: "2023-12-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

<br/>

## 7장 이항분포와 그에 관련된 분포들

### 7.3 이항분포

<br/>

#### 7.3.4 이항분포에 관한 다음 물음에 답하라.

##### (3) $n=5$에 대하여 $p=0.2, 0.5, 0.8$인 이항분포 각각에 대해 $P[X\geq4]$를 구하라.

```{r}
a = 1 - pbinom(q=3, size=5, prob=0.2)  # 3번 이하
b = 1 - pbinom(q=3, size=5, prob=0.5)
c = 1 - pbinom(q=3, size=5, prob=0.8)

print(paste(round(a, 4), ',', b, ',', round(c, 4)))
```

<br/>

#### 7.3.6 확률변수 $X$가 이항분포를 따르고 $n=5, p=0.35$일 때, $X$의 최빈값(mode)을 구하라.

```{r fig.width=4, fig.height=3.5}
data = rbinom(n=10000, size=5, prob=0.35)
barplot(table(data), space=0)             # 최빈값은 2
```

<br/>

#### 7.3.8 $n=6, p=2/3$인 이항분포에서 다음의 확률을 계산하라.

##### (1) 4번 미만으로 성공한다.

##### (2) 4번 이상 성공한다.

##### (3) 5번 이하, 2번 이상 성공한다.

```{r}
n=6
p=2/3

answer_1 = pbinom(q=3, size=n, prob=p)  # 4번 미만
answer_2 = 1 - pbinom(q=3, size=n, prob=p)  # 4번 이상
answer_3 = pbinom(q=5, size=n, prob=p) - pbinom(q=1, size=n, prob=p)  # 2~5번

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>

#### 7.3.10 미국의 백인 중 85%가 Rh+의 혈액형을 가지고 있다고 한다. 이 중에서 7명을 임의로 선택하였을 때 다음의 확률을 구하라.

##### (1) 적어도 5명이 Rh+의 혈액형을 가지고 있다.

##### (2) 많아야 3명이 Rh-(Rh+가 없는 것)의 혈액형을 가지고 있다.

```{r}
n=7
p=0.85
answer_1 = 1 - pbinom(q=4, size=n, prob=p)
answer_2 = pbinom(q=3, size=n, prob=1-p)

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.3.12 이항분포를 이용하여 다음의 확률을 구하라.

##### (1) $p=0.7$일 때, 9번의 시행 중 5번 이하 성공할 확률

##### (2) $p=0.6$일 때, 16번의 시행 중 6번 이상 11번 이하 성공할 확률

##### (3) $p=0.3$일 때, 20번의 시행 중 30%가 성공일 확률

```{r}
n=c(9, 16, 20)
p=c(0.7, 0.6, 0.3)
answer_1 = pbinom(q=5, size=n[1], prob=p[1])
answer_2 = pbinom(q=11, size=n[2], prob=p[2]) - pbinom(q=5, size=n[2], prob=p[2])
answer_3 = dbinom(x=6, size=n[3], prob=p[3])

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>

#### 7.3.14 조사결과 70%의 성인 여성이 2년 동안에 적어도 1번 내과를 찾는다고 할 때, 19명의 성인 여성이 임의로 추출되었다고 하자. 다음의 확률을 구하라.

##### (1) 14명 미만이 내과를 찾았을 확률

##### (2) 적어도 17명이 내과를 찾았을 확률

```{r}
n=19
p=0.7
answer_1 = pbinom(q=13, size=n, prob=p)
answer_2 = 1 - pbinom(q=16, size=n, prob=p)

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.3.18 20%의 3학년 학생이 장학금을 받는다고 하자. 20명의 3학년 학생을 선택하였다.

##### (1) 많아야 3명의 학생이 장학금을 받을 확률은?

##### (2) 선택된 20명 중 장학금을 받을 사람의 기대 인원수와, 기대 인원수와 같은 수의 사람이 장학금을 받을 확률은?

```{r}
n=20
p=0.2
answer_1 = pbinom(q=3, size=n, prob=p)
answer_2 = dbinom(x=4, size=n, prob=p)

cat(" (1)", answer_1, "\n", "(2) 기대인원수: 4명, 확률:", answer_2)
```

<br/>

#### 7.3.22 유전법칙에 따르면 완두콩의 우성교배를 통한 자손은 네 가지 형태이고 각각의 비율이 둥글고 노란것, 쭈그러지고 노란 것, 둥글고 녹색인 것, 쭈그러지고 녹색인 것이 9:3:3:1이라고 한다.

##### (1) 확률변수 X를 130개의 우성교배 자손에서 둥글고 노란 것의 개수라고 할 때, X의 평균과 표준편차를 구하라.

##### (2) 확률변수 Y를 85개의 우성교배 자손에서 쭈그러지고 녹색인 것의 개수라고 할 때, Y의 평균과 표준편차를 구하라.

```{r}
n_x=130
n_y=85
p_x=9/16
p_y=1/16
answer_1 = c(n_x * p_x, sqrt(n_x * p_x * (1 - p_x)))
answer_2 = c(n_y * p_y, sqrt(n_y * p_y * (1 - p_y)))

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.3.24 이항분포에 대하여 다음 물음에 답하라.

##### (1) $n=80, p=0.35$일 때, 평균과 표준편차를 구하라.

##### (2) 평균이 60, 표준편차가 6일 때, $n$, $p$를 구하라.

```{r}
n=80
p=0.35
answer_1 = c(n * p, sqrt(n * p * (1 - p)))
answer_2 = c(60 / (1 - (6^2 / 60)), 1 - (6^2 / 60))

cat(" (1)", answer_1, "\n", "(2)", answer_2)
```

<br/>

#### 7.3.26 어떤 축구 선수의 페널티킥 성공률은 70%라고 하자. 이 선수가 어느 날 10번 성공할 때까지 페널티킥을 연습한다고 할 때, 12번 이상 시도해야 할 확률을 구하라.

```{r}
# 이항분포 풀이
answer = 1 - (0.7)^10 - dbinom(x=9, size=10, prob=0.7) * 0.7  
# 음이항분포 풀이
# answer = 1 - dnbinom(x=0, size=10, prob=0.7) - dnbinom(x=1, size=10, prob=0.7)

cat(" (1)", answer_1)
```

<br/>

### 7.4 초기하분포

<br/>

#### 7.4.2 어느 회사에서 사원을 8명 모집하기 위해 신문에 광고를 내었더니 15 명의 남자와 8명의 여자가 지원하였다. 임의로 8명을 선택한다고 한다면 8명 중 여자가 3명 이상일 확률을 구하라. 예상되는 여자 신입사원은 몇 명이 되겠는가?

```{r}
n = 8
p = 8 / (15+8)
answer_1 = 1 - phyper(q=2, m=8, n=15, k=8) # help 설명 읽어보면 좋음
answer_2 = n*p

cat(" 여자가 3명 이상일 확률:", answer_1, "\n", "예상 여자 신입직원 수", answer_2)
```

<br/>

#### 7.4.6 어느 대학에서 전체 50명의 교수 중에서 5명을 뽑아 위원회를 구성하고자 한다. 선출 과정은 무작위이다. 통계학과에 6명의 교수가 있다고 하자.

##### (1) 위원회에 통계학과 교수가 한 사람도 없을 확률은?

##### (2) 적어도 1명 이상의 통계학과 교수가 포함될 확률은?

##### (3) 몇 명의 통계학과 교수가 포함되리라고 예상되는가?

```{r}
n = 5
p = 6 / 50
answer_1 = dhyper(x=0, m=6, n=44, k=5)
answer_2 = 1 - answer_1
answer_3 = n*p

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>


### 7.5 포아송분포

<br/>

#### 7.5.2 확률변수 X가 n=100, p=0.04인 이항분포를 따른다고 할 때, 포아송분포를 이용하여 다음의 근사확률을 계산하라.

##### $P[X\leq5], [X\geq7], [X=0]$

```{r}
m = 100 * 0.04
answer_1 = ppois(q = 5, lambda = m)
answer_2 = 1 - ppois(q = 6, lambda = m)
answer_3 = dpois(x=0, lambda = m)

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>

#### 7.5.4 어느 부동산 중개업소에서는 한 달에 평균 3건의 매매를 성사시킨다고 한다. 부동산의 매매가 계절의 영향을 받는다고 한다면 이는 포아송분포의 어느 성질을 위반하는 것인가?

(항상성 위배) 주어진 구간에서 사건의 평균 발생횟수의 확률분포는 구간의 시작점에는 관계가 없고 구간의 길이에만 영향을 받는다.   
※ 교재 212쪽 참고!

<br/>

#### 7.5.6 경부고속도로상의 어느 휴게소의 주유소는 평균적으로 5분에 6대 꼴로 차들이 기름을 넣으러 온다고 하자. 이때 어느 특정한 1분 동안 다음의 확률을 구하라.

##### (1) 2대 이하가 기름을 넣으러 온다.

##### (2) 2대 혹은 3대가 기름을 넣으러 온다.

##### (3) 3대 이상이 기름을 넣으러 온다.

```{r}
m = 6/5
answer_1 = ppois(q = 2, lambda = m)
answer_2 = dpois(x = 2, lambda = m) + dpois(x = 3, lambda = m)
answer_3 = 1 - answer_1

cat(" (1)", answer_1, "\n", "(2)", answer_2, "\n", "(3)", answer_3)
```

<br/>

#### 7.5.8 대학생의 94%가 휴대폰을 소유하고 있다고 한다. 대학생 100명에게 휴대폰이 있는지 없는지 알아본다고 할 때 그 중 휴대폰이 있는 사람이 90명 이하일 확률을 근사적으로 구하라.

```{r}
m = 94
answer = ppois(q = 90, lambda = m)

cat(answer)  # 이유는 모르겠는데 정답이랑 안 맞다. 정답은 0.084
```




